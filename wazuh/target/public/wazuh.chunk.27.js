(window["wazuh_bundle_jsonpfunction"]=window["wazuh_bundle_jsonpfunction"]||[]).push([[27,33],{1929:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var external_kbnSharedDeps_Lodash_=__webpack_require__(17);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(100);var classnames=__webpack_require__(130);var classnames_default=__webpack_require__.n(classnames);var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var ResizeObserver=__webpack_require__(266);var ResizeObserver_default=__webpack_require__.n(ResizeObserver);var kibana_react_public=__webpack_require__(124);var query_bar_top_row=__webpack_require__(738);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(98);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(99);function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(source==null)return{};var target=_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function GenericComboBox(props){var options=props.options,selectedOptions=props.selectedOptions,getLabel=props.getLabel,onChange=props.onChange,otherProps=_objectWithoutProperties(props,["options","selectedOptions","getLabel","onChange"]);var labels=options.map(getLabel);var euiOptions=labels.map((function(label){return{label:label}}));var selectedEuiOptions=selectedOptions.filter((function(option){return options.indexOf(option)!==-1})).map((function(option){return euiOptions[options.indexOf(option)]}));var onComboBoxChange=function onComboBoxChange(newOptions){var newValues=newOptions.map((function(_ref){var label=_ref.label;return options[labels.indexOf(label)]}));onChange(newValues)};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiComboBox"],_extends({options:euiOptions,selectedOptions:selectedEuiOptions,onChange:onComboBoxChange,sortMatchesBy:"startsWith"},otherProps))}var elastic_datemath=__webpack_require__(136);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var filter_operators=__webpack_require__(444);var common=__webpack_require__(118);function filter_editor_utils_getFieldFromFilter(filter,indexPattern){return indexPattern.fields.find((function(field){return field.name===filter.meta.key}))}function getOperatorFromFilter(filter){return filter_operators["a"].find((function(operator){return filter.meta.type===operator.type&&filter.meta.negate===operator.negate}))}function getFilterableFields(indexPattern){return indexPattern.fields.filter(common["isFilterable"])}function getOperatorOptions(field){return filter_operators["a"].filter((function(operator){return!operator.fieldTypes||operator.fieldTypes.includes(field.type)}))}function validateParams(params,type){switch(type){case"date":var moment=typeof params==="string"?elastic_datemath_default.a.parse(params):null;return Boolean(typeof params==="string"&&moment&&moment.isValid());case"ip":try{return Boolean(new common["Ipv4Address"](params))}catch(e){return false}default:return true}}function filter_editor_utils_isFilterValid(indexPattern,field,operator,params){if(!indexPattern||!field||!operator){return false}switch(operator.type){case"phrase":return validateParams(params,field.type);case"phrases":if(!Array.isArray(params)||!params.length){return false}return params.every((function(phrase){return validateParams(phrase,field.type)}));case"range":if(typeof params!=="object"){return false}return(!params.from||validateParams(params.from,field.type))&&(!params.to||validateParams(params.to,field.type));case"exists":return true;default:throw new Error("Unknown operator type: ".concat(operator.type))}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var phrase_suggestor_PhraseSuggestorUI=function(_React$Component){_inherits(PhraseSuggestorUI,_React$Component);var _super=_createSuper(PhraseSuggestorUI);function PhraseSuggestorUI(){var _this;_classCallCheck(this,PhraseSuggestorUI);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));_defineProperty(_assertThisInitialized(_this),"services",_this.props.kibana.services);_defineProperty(_assertThisInitialized(_this),"abortController",void 0);_defineProperty(_assertThisInitialized(_this),"state",{suggestions:[],isLoading:false});_defineProperty(_assertThisInitialized(_this),"onSearchChange",(function(value){_this.updateSuggestions("".concat(value))}));_defineProperty(_assertThisInitialized(_this),"updateSuggestions",Object(external_kbnSharedDeps_Lodash_["debounce"])(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var query,_ref2,indexPattern,field,suggestions,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:query=_args.length>0&&_args[0]!==undefined?_args[0]:"";if(_this.abortController)_this.abortController.abort();_this.abortController=new AbortController;_ref2=_this.props,indexPattern=_ref2.indexPattern,field=_ref2.field;if(!(!field||!_this.isSuggestingValues())){_context.next=6;break}return _context.abrupt("return");case 6:_this.setState({isLoading:true});_context.next=9;return _this.services.data.autocomplete.getValueSuggestions({indexPattern:indexPattern,field:field,query:query,signal:_this.abortController.signal});case 9:suggestions=_context.sent;_this.setState({suggestions:suggestions,isLoading:false});case 11:case"end":return _context.stop()}}}),_callee)}))),500));return _this}_createClass(PhraseSuggestorUI,[{key:"componentDidMount",value:function componentDidMount(){this.updateSuggestions()}},{key:"componentWillUnmount",value:function componentWillUnmount(){if(this.abortController)this.abortController.abort()}},{key:"isSuggestingValues",value:function isSuggestingValues(){var shouldSuggestValues=this.services.uiSettings.get(common["UI_SETTINGS"].FILTERS_EDITOR_SUGGEST_VALUES);var field=this.props.field;return shouldSuggestValues&&field&&field.aggregatable&&field.type==="string"}}]);return PhraseSuggestorUI}(external_kbnSharedDeps_React_default.a.Component);var PhraseSuggestor=Object(kibana_react_public["withKibana"])(phrase_suggestor_PhraseSuggestorUI);function value_input_type_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function value_input_type_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function value_input_type_createClass(Constructor,protoProps,staticProps){if(protoProps)value_input_type_defineProperties(Constructor.prototype,protoProps);if(staticProps)value_input_type_defineProperties(Constructor,staticProps);return Constructor}function value_input_type_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)value_input_type_setPrototypeOf(subClass,superClass)}function value_input_type_setPrototypeOf(o,p){value_input_type_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return value_input_type_setPrototypeOf(o,p)}function value_input_type_createSuper(Derived){var hasNativeReflectConstruct=value_input_type_isNativeReflectConstruct();return function _createSuperInternal(){var Super=value_input_type_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=value_input_type_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return value_input_type_possibleConstructorReturn(this,result)}}function value_input_type_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return value_input_type_assertThisInitialized(self)}function value_input_type_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function value_input_type_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function value_input_type_getPrototypeOf(o){value_input_type_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return value_input_type_getPrototypeOf(o)}function value_input_type_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var value_input_type_ValueInputTypeUI=function(_Component){value_input_type_inherits(ValueInputTypeUI,_Component);var _super=value_input_type_createSuper(ValueInputTypeUI);function ValueInputTypeUI(){var _this;value_input_type_classCallCheck(this,ValueInputTypeUI);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));value_input_type_defineProperty(value_input_type_assertThisInitialized(_this),"onBoolChange",(function(event){var boolValue=event.target.value==="true";_this.props.onChange(boolValue)}));value_input_type_defineProperty(value_input_type_assertThisInitialized(_this),"onChange",(function(event){var params=event.target.value;_this.props.onChange(params)}));value_input_type_defineProperty(value_input_type_assertThisInitialized(_this),"onBlur",(function(event){if(_this.props.onBlur){var params=event.target.value;_this.props.onBlur(params)}}));return _this}value_input_type_createClass(ValueInputTypeUI,[{key:"render",value:function render(){var value=this.props.value;var inputElement;switch(this.props.type){case"string":inputElement=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{placeholder:this.props.placeholder,value:value,onChange:this.onChange,controlOnly:this.props.controlOnly,className:this.props.className});break;case"number":inputElement=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldNumber"],{placeholder:this.props.placeholder,value:typeof value==="string"?parseFloat(value):value,onChange:this.onChange,controlOnly:this.props.controlOnly,className:this.props.className});break;case"date":inputElement=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{placeholder:this.props.placeholder,value:value,onChange:this.onChange,onBlur:this.onBlur,isInvalid:!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(value)&&!validateParams(value,this.props.type),controlOnly:this.props.controlOnly,className:this.props.className});break;case"ip":inputElement=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{placeholder:this.props.placeholder,value:value,onChange:this.onChange,isInvalid:!Object(external_kbnSharedDeps_Lodash_["isEmpty"])(value)&&!validateParams(value,this.props.type),controlOnly:this.props.controlOnly,className:this.props.className});break;case"boolean":inputElement=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSelect"],{options:[{value:undefined,text:this.props.placeholder},{value:"true",text:this.props.intl.formatMessage({id:"data.filter.filterEditor.trueOptionLabel",defaultMessage:"true"})},{value:"false",text:this.props.intl.formatMessage({id:"data.filter.filterEditor.falseOptionLabel",defaultMessage:"false"})}],value:value,onChange:this.onBoolChange,className:this.props.className});break;default:break}return inputElement}}]);return ValueInputTypeUI}(external_kbnSharedDeps_React_["Component"]);var ValueInputType=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(value_input_type_ValueInputTypeUI);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function phrase_value_input_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function phrase_value_input_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function phrase_value_input_createClass(Constructor,protoProps,staticProps){if(protoProps)phrase_value_input_defineProperties(Constructor.prototype,protoProps);if(staticProps)phrase_value_input_defineProperties(Constructor,staticProps);return Constructor}function phrase_value_input_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)phrase_value_input_setPrototypeOf(subClass,superClass)}function phrase_value_input_setPrototypeOf(o,p){phrase_value_input_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return phrase_value_input_setPrototypeOf(o,p)}function phrase_value_input_createSuper(Derived){var hasNativeReflectConstruct=phrase_value_input_isNativeReflectConstruct();return function _createSuperInternal(){var Super=phrase_value_input_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=phrase_value_input_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return phrase_value_input_possibleConstructorReturn(this,result)}}function phrase_value_input_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return phrase_value_input_assertThisInitialized(self)}function phrase_value_input_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function phrase_value_input_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function phrase_value_input_getPrototypeOf(o){phrase_value_input_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return phrase_value_input_getPrototypeOf(o)}var phrase_value_input_PhraseValueInputUI=function(_PhraseSuggestorUI){phrase_value_input_inherits(PhraseValueInputUI,_PhraseSuggestorUI);var _super=phrase_value_input_createSuper(PhraseValueInputUI);function PhraseValueInputUI(){phrase_value_input_classCallCheck(this,PhraseValueInputUI);return _super.apply(this,arguments)}phrase_value_input_createClass(PhraseValueInputUI,[{key:"render",value:function render(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.intl.formatMessage({id:"data.filter.filterEditor.valueInputLabel",defaultMessage:"Value"})},this.isSuggestingValues()?this.renderWithSuggestions():external_kbnSharedDeps_React_default.a.createElement(ValueInputType,{placeholder:this.props.intl.formatMessage({id:"data.filter.filterEditor.valueInputPlaceholder",defaultMessage:"Enter a value"}),value:this.props.value,onChange:this.props.onChange,type:this.props.field?this.props.field.type:"string"}))}},{key:"renderWithSuggestions",value:function renderWithSuggestions(){var suggestions=this.state.suggestions;var _this$props=this.props,value=_this$props.value,intl=_this$props.intl,_onChange=_this$props.onChange;var valueAsStr=String(value);var options=value?Object(external_kbnSharedDeps_Lodash_["uniq"])([valueAsStr].concat(_toConsumableArray(suggestions))):suggestions;return external_kbnSharedDeps_React_default.a.createElement(StringComboBox,{placeholder:intl.formatMessage({id:"data.filter.filterEditor.valueSelectPlaceholder",defaultMessage:"Select a value"}),options:options,getLabel:function getLabel(option){return option},selectedOptions:value?[valueAsStr]:[],onChange:function onChange(_ref){var _ref2=_slicedToArray(_ref,1),_ref2$=_ref2[0],newValue=_ref2$===void 0?"":_ref2$;return _onChange(newValue)},onSearchChange:this.onSearchChange,singleSelection:{asPlainText:true},onCreateOption:_onChange,isClearable:false,"data-test-subj":"filterParamsComboBox phraseParamsComboxBox"})}}]);return PhraseValueInputUI}(phrase_suggestor_PhraseSuggestorUI);function StringComboBox(props){return GenericComboBox(props)}var PhraseValueInput=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(Object(kibana_react_public["withKibana"])(phrase_value_input_PhraseValueInputUI));function phrases_values_input_toConsumableArray(arr){return phrases_values_input_arrayWithoutHoles(arr)||phrases_values_input_iterableToArray(arr)||phrases_values_input_unsupportedIterableToArray(arr)||phrases_values_input_nonIterableSpread()}function phrases_values_input_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function phrases_values_input_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return phrases_values_input_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return phrases_values_input_arrayLikeToArray(o,minLen)}function phrases_values_input_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function phrases_values_input_arrayWithoutHoles(arr){if(Array.isArray(arr))return phrases_values_input_arrayLikeToArray(arr)}function phrases_values_input_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function phrases_values_input_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function phrases_values_input_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function phrases_values_input_createClass(Constructor,protoProps,staticProps){if(protoProps)phrases_values_input_defineProperties(Constructor.prototype,protoProps);if(staticProps)phrases_values_input_defineProperties(Constructor,staticProps);return Constructor}function phrases_values_input_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)phrases_values_input_setPrototypeOf(subClass,superClass)}function phrases_values_input_setPrototypeOf(o,p){phrases_values_input_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return phrases_values_input_setPrototypeOf(o,p)}function phrases_values_input_createSuper(Derived){var hasNativeReflectConstruct=phrases_values_input_isNativeReflectConstruct();return function _createSuperInternal(){var Super=phrases_values_input_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=phrases_values_input_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return phrases_values_input_possibleConstructorReturn(this,result)}}function phrases_values_input_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return phrases_values_input_assertThisInitialized(self)}function phrases_values_input_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function phrases_values_input_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function phrases_values_input_getPrototypeOf(o){phrases_values_input_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return phrases_values_input_getPrototypeOf(o)}var phrases_values_input_PhrasesValuesInputUI=function(_PhraseSuggestorUI){phrases_values_input_inherits(PhrasesValuesInputUI,_PhraseSuggestorUI);var _super=phrases_values_input_createSuper(PhrasesValuesInputUI);function PhrasesValuesInputUI(){phrases_values_input_classCallCheck(this,PhrasesValuesInputUI);return _super.apply(this,arguments)}phrases_values_input_createClass(PhrasesValuesInputUI,[{key:"render",value:function render(){var suggestions=this.state.suggestions;var _this$props=this.props,values=_this$props.values,intl=_this$props.intl,onChange=_this$props.onChange;var options=values?Object(external_kbnSharedDeps_Lodash_["uniq"])([].concat(phrases_values_input_toConsumableArray(values),phrases_values_input_toConsumableArray(suggestions))):suggestions;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:intl.formatMessage({id:"data.filter.filterEditor.valuesSelectLabel",defaultMessage:"Values"})},external_kbnSharedDeps_React_default.a.createElement(phrases_values_input_StringComboBox,{placeholder:intl.formatMessage({id:"data.filter.filterEditor.valuesSelectPlaceholder",defaultMessage:"Select values"}),options:options,getLabel:function getLabel(option){return option},selectedOptions:values||[],onSearchChange:this.onSearchChange,onCreateOption:function onCreateOption(option){return onChange([].concat(phrases_values_input_toConsumableArray(values||[]),[option]))},onChange:onChange,isClearable:false,"data-test-subj":"filterParamsComboBox phrasesParamsComboxBox"}))}}]);return PhrasesValuesInputUI}(phrase_suggestor_PhraseSuggestorUI);function phrases_values_input_StringComboBox(props){return GenericComboBox(props)}var PhrasesValuesInput=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(Object(kibana_react_public["withKibana"])(phrases_values_input_PhrasesValuesInputUI));var external_kbnSharedDeps_Moment_=__webpack_require__(102);var external_kbnSharedDeps_Moment_default=__webpack_require__.n(external_kbnSharedDeps_Moment_);function RangeValueInputUI(props){var kibana=Object(kibana_react_public["useKibana"])();var type=props.field?props.field.type:"string";var tzConfig=kibana.services.uiSettings.get("dateFormat:tz");var formatDateChange=function formatDateChange(value){if(typeof value!=="string"&&typeof value!=="number")return value;var momentParsedValue=external_kbnSharedDeps_Moment_default()(value).tz(tzConfig);if(momentParsedValue.isValid())return momentParsedValue===null||momentParsedValue===void 0?void 0:momentParsedValue.format("YYYY-MM-DDTHH:mm:ss.SSSZ");return value};var onFromChange=function onFromChange(value){if(typeof value!=="string"&&typeof value!=="number"){throw new Error("Range params must be a string or number")}props.onChange({from:value,to:Object(external_kbnSharedDeps_Lodash_["get"])(props,"value.to")})};var onToChange=function onToChange(value){if(typeof value!=="string"&&typeof value!=="number"){throw new Error("Range params must be a string or number")}props.onChange({from:Object(external_kbnSharedDeps_Lodash_["get"])(props,"value.from"),to:value})};return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormControlLayoutDelimited"],{"aria-label":props.intl.formatMessage({id:"data.filter.filterEditor.rangeInputLabel",defaultMessage:"Range"}),startControl:external_kbnSharedDeps_React_default.a.createElement(ValueInputType,{controlOnly:true,type:type,value:props.value?props.value.from:undefined,onChange:onFromChange,onBlur:function onBlur(value){onFromChange(formatDateChange(value))},placeholder:props.intl.formatMessage({id:"data.filter.filterEditor.rangeStartInputPlaceholder",defaultMessage:"Start of the range"})}),endControl:external_kbnSharedDeps_React_default.a.createElement(ValueInputType,{controlOnly:true,type:type,value:props.value?props.value.to:undefined,onChange:onToChange,onBlur:function onBlur(value){onToChange(formatDateChange(value))},placeholder:props.intl.formatMessage({id:"data.filter.filterEditor.rangeEndInputPlaceholder",defaultMessage:"End of the range"})})}))}var RangeValueInput=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(RangeValueInputUI);function filter_editor_slicedToArray(arr,i){return filter_editor_arrayWithHoles(arr)||filter_editor_iterableToArrayLimit(arr,i)||filter_editor_unsupportedIterableToArray(arr,i)||filter_editor_nonIterableRest()}function filter_editor_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_editor_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_editor_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_editor_arrayLikeToArray(o,minLen)}function filter_editor_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function filter_editor_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_editor_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function filter_editor_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function filter_editor_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function filter_editor_createClass(Constructor,protoProps,staticProps){if(protoProps)filter_editor_defineProperties(Constructor.prototype,protoProps);if(staticProps)filter_editor_defineProperties(Constructor,staticProps);return Constructor}function filter_editor_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)filter_editor_setPrototypeOf(subClass,superClass)}function filter_editor_setPrototypeOf(o,p){filter_editor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return filter_editor_setPrototypeOf(o,p)}function filter_editor_createSuper(Derived){var hasNativeReflectConstruct=filter_editor_isNativeReflectConstruct();return function _createSuperInternal(){var Super=filter_editor_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=filter_editor_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return filter_editor_possibleConstructorReturn(this,result)}}function filter_editor_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return filter_editor_assertThisInitialized(self)}function filter_editor_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function filter_editor_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function filter_editor_getPrototypeOf(o){filter_editor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return filter_editor_getPrototypeOf(o)}function filter_editor_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var filter_editor_FilterEditorUI=function(_Component){filter_editor_inherits(FilterEditorUI,_Component);var _super=filter_editor_createSuper(FilterEditorUI);function FilterEditorUI(props){var _this;filter_editor_classCallCheck(this,FilterEditorUI);_this=_super.call(this,props);filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"toggleCustomEditor",(function(){var isCustomEditorOpen=!_this.state.isCustomEditorOpen;_this.setState({isCustomEditorOpen:isCustomEditorOpen})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onIndexPatternChange",(function(_ref){var _ref2=filter_editor_slicedToArray(_ref,1),selectedIndexPattern=_ref2[0];var selectedField=undefined;var selectedOperator=undefined;var params=undefined;_this.setState({selectedIndexPattern:selectedIndexPattern,selectedField:selectedField,selectedOperator:selectedOperator,params:params})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onFieldChange",(function(_ref3){var _ref4=filter_editor_slicedToArray(_ref3,1),selectedField=_ref4[0];var selectedOperator=undefined;var params=undefined;_this.setState({selectedField:selectedField,selectedOperator:selectedOperator,params:params})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onOperatorChange",(function(_ref5){var _ref6=filter_editor_slicedToArray(_ref5,1),selectedOperator=_ref6[0];var params=Object(external_kbnSharedDeps_Lodash_["get"])(_this.state.selectedOperator,"type")===Object(external_kbnSharedDeps_Lodash_["get"])(selectedOperator,"type")?_this.state.params:undefined;_this.setState({selectedOperator:selectedOperator,params:params})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onCustomLabelSwitchChange",(function(event){var useCustomLabel=event.target.checked;var customLabel=event.target.checked?"":null;_this.setState({useCustomLabel:useCustomLabel,customLabel:customLabel})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onCustomLabelChange",(function(event){var customLabel=event.target.value;_this.setState({customLabel:customLabel})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onParamsChange",(function(params){_this.setState({params:params})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onQueryDslChange",(function(queryDsl){_this.setState({queryDsl:queryDsl})}));filter_editor_defineProperty(filter_editor_assertThisInitialized(_this),"onSubmit",(function(){var _this$state=_this.state,indexPattern=_this$state.selectedIndexPattern,field=_this$state.selectedField,operator=_this$state.selectedOperator,params=_this$state.params,useCustomLabel=_this$state.useCustomLabel,customLabel=_this$state.customLabel,isCustomEditorOpen=_this$state.isCustomEditorOpen,queryDsl=_this$state.queryDsl;var $state=_this.props.filter.$state;if(!$state||!$state.store){return}var alias=useCustomLabel?customLabel:null;if(isCustomEditorOpen){var _this$props$filter$me=_this.props.filter.meta,index=_this$props$filter$me.index,disabled=_this$props$filter$me.disabled,negate=_this$props$filter$me.negate;var newIndex=index||_this.props.indexPatterns[0].id;var body=JSON.parse(queryDsl);var _filter=Object(common["buildCustomFilter"])(newIndex,body,disabled,negate,alias,$state.store);_this.props.onSubmit(_filter)}else if(indexPattern&&field&&operator){var _filter2=Object(common["buildFilter"])(indexPattern,field,operator.type,operator.negate,_this.props.filter.meta.disabled,params!==null&&params!==void 0?params:"",alias,$state.store);_this.props.onSubmit(_filter2)}}));_this.state={selectedIndexPattern:_this.getIndexPatternFromFilter(),selectedField:_this.getFieldFromFilter(),selectedOperator:_this.getSelectedOperator(),params:Object(common["getFilterParams"])(props.filter),useCustomLabel:props.filter.meta.alias!==null,customLabel:props.filter.meta.alias,queryDsl:JSON.stringify(Object(common["cleanFilter"])(props.filter),null,2),isCustomEditorOpen:_this.isUnknownFilterType()};return _this}filter_editor_createClass(FilterEditorUI,[{key:"render",value:function render(){return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{alignItems:"baseline",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.filterEditor.editFilterPopupTitle",defaultMessage:"Edit filter"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,className:"filterEditor__hiddenItem"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs","data-test-subj":"editQueryDSL",onClick:this.toggleCustomEditor},this.state.isCustomEditorOpen?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.filterEditor.editFilterValuesButtonLabel",defaultMessage:"Edit filter values"}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.filterEditor.editQueryDslButtonLabel",defaultMessage:"Edit as Query DSL"}))))),external_kbnSharedDeps_React_default.a.createElement("div",{className:"globalFilterItem__editorForm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],null,this.renderIndexPatternInput(),this.state.isCustomEditorOpen?this.renderCustomEditor():this.renderRegularEditor(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{id:"filterEditorCustomLabelSwitch","data-test-subj":"createCustomLabel",label:this.props.intl.formatMessage({id:"data.filter.filterEditor.createCustomLabelSwitchLabel",defaultMessage:"Create custom label?"}),checked:this.state.useCustomLabel,onChange:this.onCustomLabelSwitchChange}),this.state.useCustomLabel&&external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.intl.formatMessage({id:"data.filter.filterEditor.createCustomLabelInputLabel",defaultMessage:"Custom label"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:"".concat(this.state.customLabel),onChange:this.onCustomLabelChange}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"m"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"rowReverse",alignItems:"center",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{fill:true,onClick:this.onSubmit,isDisabled:!this.isFilterValid(),"data-test-subj":"saveFilter"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.filterEditor.saveButtonLabel",defaultMessage:"Save"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{flush:"right",onClick:this.props.onCancel,"data-test-subj":"cancelSaveFilter"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.filterEditor.cancelButtonLabel",defaultMessage:"Cancel"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null)))))}},{key:"renderIndexPatternInput",value:function renderIndexPatternInput(){var _this2=this;if(this.props.indexPatterns.length<=1&&this.props.indexPatterns.find((function(indexPattern){return indexPattern===_this2.getIndexPatternFromFilter()}))){return""}var selectedIndexPattern=this.state.selectedIndexPattern;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.intl.formatMessage({id:"data.filter.filterEditor.indexPatternSelectLabel",defaultMessage:"Index Pattern"})},external_kbnSharedDeps_React_default.a.createElement(IndexPatternComboBox,{placeholder:this.props.intl.formatMessage({id:"data.filter.filterBar.indexPatternSelectPlaceholder",defaultMessage:"Select an index pattern"}),options:this.props.indexPatterns,selectedOptions:selectedIndexPattern?[selectedIndexPattern]:[],getLabel:function getLabel(indexPattern){return indexPattern.title},onChange:this.onIndexPatternChange,singleSelection:{asPlainText:true},isClearable:false,"data-test-subj":"filterIndexPatternsSelect"}))))}},{key:"renderRegularEditor",value:function renderRegularEditor(){return external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:2},this.renderFieldInput()),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false,style:{flexBasis:160}},this.renderOperatorInput())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"}),external_kbnSharedDeps_React_default.a.createElement("div",{"data-test-subj":"filterParams"},this.renderParamsEditor()))}},{key:"renderFieldInput",value:function renderFieldInput(){var _this$state2=this.state,selectedIndexPattern=_this$state2.selectedIndexPattern,selectedField=_this$state2.selectedField;var fields=selectedIndexPattern?getFilterableFields(selectedIndexPattern):[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.intl.formatMessage({id:"data.filter.filterEditor.fieldSelectLabel",defaultMessage:"Field"})},external_kbnSharedDeps_React_default.a.createElement(FieldComboBox,{id:"fieldInput",isDisabled:!selectedIndexPattern,placeholder:this.props.intl.formatMessage({id:"data.filter.filterEditor.fieldSelectPlaceholder",defaultMessage:"Select a field first"}),options:fields,selectedOptions:selectedField?[selectedField]:[],getLabel:function getLabel(field){return field.name},onChange:this.onFieldChange,singleSelection:{asPlainText:true},isClearable:false,className:"globalFilterEditor__fieldInput","data-test-subj":"filterFieldSuggestionList"}))}},{key:"renderOperatorInput",value:function renderOperatorInput(){var _this$state3=this.state,selectedField=_this$state3.selectedField,selectedOperator=_this$state3.selectedOperator;var operators=selectedField?getOperatorOptions(selectedField):[];return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:this.props.intl.formatMessage({id:"data.filter.filterEditor.operatorSelectLabel",defaultMessage:"Operator"})},external_kbnSharedDeps_React_default.a.createElement(OperatorComboBox,{isDisabled:!selectedField,placeholder:selectedField?this.props.intl.formatMessage({id:"data.filter.filterEditor.operatorSelectPlaceholderSelect",defaultMessage:"Select"}):this.props.intl.formatMessage({id:"data.filter.filterEditor.operatorSelectPlaceholderWaiting",defaultMessage:"Waiting"}),options:operators,selectedOptions:selectedOperator?[selectedOperator]:[],getLabel:function getLabel(_ref7){var message=_ref7.message;return message},onChange:this.onOperatorChange,singleSelection:{asPlainText:true},isClearable:false,"data-test-subj":"filterOperatorList"}))}},{key:"renderCustomEditor",value:function renderCustomEditor(){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.filter.filterEditor.queryDslLabel",{defaultMessage:"Elasticsearch Query DSL"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiCodeEditor"],{value:this.state.queryDsl,onChange:this.onQueryDslChange,mode:"json",width:"100%",height:"250px"}))}},{key:"renderParamsEditor",value:function renderParamsEditor(){var indexPattern=this.state.selectedIndexPattern;if(!indexPattern||!this.state.selectedOperator){return""}switch(this.state.selectedOperator.type){case"exists":return"";case"phrase":return external_kbnSharedDeps_React_default.a.createElement(PhraseValueInput,{indexPattern:indexPattern,field:this.state.selectedField,value:this.state.params,onChange:this.onParamsChange,"data-test-subj":"phraseValueInput"});case"phrases":return external_kbnSharedDeps_React_default.a.createElement(PhrasesValuesInput,{indexPattern:indexPattern,field:this.state.selectedField,values:this.state.params,onChange:this.onParamsChange});case"range":return external_kbnSharedDeps_React_default.a.createElement(RangeValueInput,{field:this.state.selectedField,value:this.state.params,onChange:this.onParamsChange})}}},{key:"isUnknownFilterType",value:function isUnknownFilterType(){var type=this.props.filter.meta.type;return!!type&&!["phrase","phrases","range","exists"].includes(type)}},{key:"getIndexPatternFromFilter",value:function getIndexPatternFromFilter(){return Object(common["getIndexPatternFromFilter"])(this.props.filter,this.props.indexPatterns)}},{key:"getFieldFromFilter",value:function getFieldFromFilter(){var indexPattern=this.getIndexPatternFromFilter();return indexPattern&&filter_editor_utils_getFieldFromFilter(this.props.filter,indexPattern)}},{key:"getSelectedOperator",value:function getSelectedOperator(){return getOperatorFromFilter(this.props.filter)}},{key:"isFilterValid",value:function isFilterValid(){var _this$state4=this.state,isCustomEditorOpen=_this$state4.isCustomEditorOpen,queryDsl=_this$state4.queryDsl,indexPattern=_this$state4.selectedIndexPattern,field=_this$state4.selectedField,operator=_this$state4.selectedOperator,params=_this$state4.params;if(isCustomEditorOpen){try{return Boolean(JSON.parse(queryDsl))}catch(e){return false}}return filter_editor_utils_isFilterValid(indexPattern,field,operator,params)}}]);return FilterEditorUI}(external_kbnSharedDeps_React_["Component"]);function IndexPatternComboBox(props){return GenericComboBox(props)}function FieldComboBox(props){return GenericComboBox(props)}function OperatorComboBox(props){return GenericComboBox(props)}var FilterEditor=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(filter_editor_FilterEditorUI);var filter_bar=__webpack_require__(283);function filter_view_extends(){filter_view_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return filter_view_extends.apply(this,arguments)}function filter_view_slicedToArray(arr,i){return filter_view_arrayWithHoles(arr)||filter_view_iterableToArrayLimit(arr,i)||filter_view_unsupportedIterableToArray(arr,i)||filter_view_nonIterableRest()}function filter_view_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_view_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_view_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_view_arrayLikeToArray(o,minLen)}function filter_view_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function filter_view_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_view_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function filter_view_objectWithoutProperties(source,excluded){if(source==null)return{};var target=filter_view_objectWithoutPropertiesLoose(source,excluded);var key,i;if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++){key=sourceSymbolKeys[i];if(excluded.indexOf(key)>=0)continue;if(!Object.prototype.propertyIsEnumerable.call(source,key))continue;target[key]=source[key]}}return target}function filter_view_objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}var filter_view_FilterView=function FilterView(_ref){var filter=_ref.filter,iconOnClick=_ref.iconOnClick,onClick=_ref.onClick,valueLabel=_ref.valueLabel,errorMessage=_ref.errorMessage,filterLabelStatus=_ref.filterLabelStatus,rest=filter_view_objectWithoutProperties(_ref,["filter","iconOnClick","onClick","valueLabel","errorMessage","filterLabelStatus"]);var _useInnerText=Object(external_kbnSharedDeps_ElasticEui_["useInnerText"])(),_useInnerText2=filter_view_slicedToArray(_useInnerText,2),ref=_useInnerText2[0],innerText=_useInnerText2[1];var title=errorMessage||external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.filter.filterBar.moreFilterActionsMessage",{defaultMessage:"Filter: {innerText}. Select for more filter actions.",values:{innerText:innerText}});if(Object(common["isFilterPinned"])(filter)){title="".concat(external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.filter.filterBar.pinnedFilterPrefix",{defaultMessage:"Pinned"})," ").concat(title)}if(filter.meta.disabled){title="".concat(external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.filter.filterBar.disabledFilterPrefix",{defaultMessage:"Disabled"})," ").concat(title)}return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiBadge"],filter_view_extends({title:title,color:"hollow",iconType:"cross",iconSide:"right",closeButtonProps:{tabIndex:-1},iconOnClick:iconOnClick,iconOnClickAriaLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.filter.filterBar.filterItemBadgeIconAriaLabel",{defaultMessage:"Delete"}),onClick:onClick,onClickAriaLabel:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.filter.filterBar.filterItemBadgeAriaLabel",{defaultMessage:"Filter actions"})},rest),external_kbnSharedDeps_React_default.a.createElement("span",{ref:ref},external_kbnSharedDeps_React_default.a.createElement(filter_bar["a"],{filter:filter,valueLabel:valueLabel,filterLabelStatus:filterLabelStatus})))};var services=__webpack_require__(155);function filter_item_toConsumableArray(arr){return filter_item_arrayWithoutHoles(arr)||filter_item_iterableToArray(arr)||filter_item_unsupportedIterableToArray(arr)||filter_item_nonIterableSpread()}function filter_item_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_item_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function filter_item_arrayWithoutHoles(arr){if(Array.isArray(arr))return filter_item_arrayLikeToArray(arr)}function filter_item_slicedToArray(arr,i){return filter_item_arrayWithHoles(arr)||filter_item_iterableToArrayLimit(arr,i)||filter_item_unsupportedIterableToArray(arr,i)||filter_item_nonIterableRest()}function filter_item_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_item_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_item_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_item_arrayLikeToArray(o,minLen)}function filter_item_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function filter_item_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_item_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var FILTER_ITEM_OK="";var FILTER_ITEM_WARNING="warn";var FILTER_ITEM_ERROR="error";function FilterItem(props){var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=filter_item_slicedToArray(_useState,2),isPopoverOpen=_useState2[0],setIsPopoverOpen=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(undefined),_useState4=filter_item_slicedToArray(_useState3,2),indexPatternExists=_useState4[0],setIndexPatternExists=_useState4[1];var id=props.id,filter=props.filter,indexPatterns=props.indexPatterns;Object(external_kbnSharedDeps_React_["useEffect"])((function(){var index=props.filter.meta.index;if(index){Object(services["b"])().get(index).then((function(indexPattern){setIndexPatternExists(!!indexPattern)})).catch((function(){setIndexPatternExists(false)}))}else{setIndexPatternExists(true)}}),[props.filter.meta.index]);function handleBadgeClick(e){if(e.shiftKey){onToggleDisabled()}else{setIsPopoverOpen(!isPopoverOpen)}}function onSubmit(f){setIsPopoverOpen(false);props.onUpdate(f)}function onTogglePinned(){var f=Object(common["toggleFilterPinned"])(filter);props.onUpdate(f)}function onToggleNegated(){var f=Object(common["toggleFilterNegated"])(filter);props.onUpdate(f)}function onToggleDisabled(){var f=Object(common["toggleFilterDisabled"])(filter);props.onUpdate(f)}function isValidLabel(labelConfig){return labelConfig.status===FILTER_ITEM_OK}function isDisabled(labelConfig){var disabled=filter.meta.disabled;return disabled||labelConfig.status===FILTER_ITEM_ERROR}function getClasses(negate,labelConfig){return classnames_default()("globalFilterItem",{"globalFilterItem-isDisabled":isDisabled(labelConfig),"globalFilterItem-isError":labelConfig.status===FILTER_ITEM_ERROR,"globalFilterItem-isWarning":labelConfig.status===FILTER_ITEM_WARNING,"globalFilterItem-isPinned":Object(common["isFilterPinned"])(filter),"globalFilterItem-isExcluded":negate},props.className)}function getDataTestSubj(labelConfig){var dataTestSubjKey=filter.meta.key?"filter-key-".concat(filter.meta.key):"";var dataTestSubjValue=filter.meta.value?"filter-value-".concat(isValidLabel(labelConfig)?labelConfig.title:labelConfig.status):"";var dataTestSubjNegated=filter.meta.negate?"filter-negated":"";var dataTestSubjDisabled="filter-".concat(isDisabled(labelConfig)?"disabled":"enabled");var dataTestSubjPinned="filter-".concat(Object(common["isFilterPinned"])(filter)?"pinned":"unpinned");return"filter ".concat(dataTestSubjDisabled," ").concat(dataTestSubjKey," ").concat(dataTestSubjValue," ").concat(dataTestSubjPinned," ").concat(dataTestSubjNegated)}function getPanels(){var _filter$meta=filter.meta,negate=_filter$meta.negate,disabled=_filter$meta.disabled;return[{id:0,items:[{name:Object(common["isFilterPinned"])(filter)?props.intl.formatMessage({id:"data.filter.filterBar.unpinFilterButtonLabel",defaultMessage:"Unpin"}):props.intl.formatMessage({id:"data.filter.filterBar.pinFilterButtonLabel",defaultMessage:"Pin across all apps"}),icon:"pin",onClick:function onClick(){setIsPopoverOpen(false);onTogglePinned()},"data-test-subj":"pinFilter"},{name:props.intl.formatMessage({id:"data.filter.filterBar.editFilterButtonLabel",defaultMessage:"Edit filter"}),icon:"pencil",panel:1,"data-test-subj":"editFilter"},{name:negate?props.intl.formatMessage({id:"data.filter.filterBar.includeFilterButtonLabel",defaultMessage:"Include results"}):props.intl.formatMessage({id:"data.filter.filterBar.excludeFilterButtonLabel",defaultMessage:"Exclude results"}),icon:negate?"plusInCircle":"minusInCircle",onClick:function onClick(){setIsPopoverOpen(false);onToggleNegated()},"data-test-subj":"negateFilter"},{name:disabled?props.intl.formatMessage({id:"data.filter.filterBar.enableFilterButtonLabel",defaultMessage:"Re-enable"}):props.intl.formatMessage({id:"data.filter.filterBar.disableFilterButtonLabel",defaultMessage:"Temporarily disable"}),icon:"".concat(disabled?"eye":"eyeClosed"),onClick:function onClick(){setIsPopoverOpen(false);onToggleDisabled()},"data-test-subj":"disableFilter"},{name:props.intl.formatMessage({id:"data.filter.filterBar.deleteFilterButtonLabel",defaultMessage:"Delete"}),icon:"trash",onClick:function onClick(){setIsPopoverOpen(false);props.onRemove()},"data-test-subj":"deleteFilter"}]},{id:1,width:420,content:external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement(FilterEditor,{filter:filter,indexPatterns:indexPatterns,onSubmit:onSubmit,onCancel:function onCancel(){setIsPopoverOpen(false)}}))}]}function isFilterApplicable(){var _filter$meta2;if(!props.indexPatterns.length)return true;var ip=Object(common["getIndexPatternFromFilter"])(filter,indexPatterns);if(ip)return true;var allFields=indexPatterns.map((function(indexPattern){return indexPattern.fields.map((function(field){return field.name}))}));var flatFields=allFields.reduce((function(acc,it){return[].concat(filter_item_toConsumableArray(acc),filter_item_toConsumableArray(it))}),[]);return flatFields.includes(((_filter$meta2=filter.meta)===null||_filter$meta2===void 0?void 0:_filter$meta2.key)||"")}function getValueLabel(){var label={title:"",message:"",status:FILTER_ITEM_OK};if(indexPatternExists===false){label.status=FILTER_ITEM_ERROR;label.title=props.intl.formatMessage({id:"data.filter.filterBar.labelErrorText",defaultMessage:"Error"});label.message=props.intl.formatMessage({id:"data.filter.filterBar.labelErrorInfo",defaultMessage:"Index pattern {indexPattern} not found"},{indexPattern:filter.meta.index})}else if(isFilterApplicable()){try{label.title=Object(common["getDisplayValueFromFilter"])(filter,indexPatterns)}catch(e){label.status=FILTER_ITEM_ERROR;label.title=props.intl.formatMessage({id:"data.filter.filterBar.labelErrorText",defaultMessage:"Error"});label.message=e.message}}else{label.status=FILTER_ITEM_WARNING;label.title=props.intl.formatMessage({id:"data.filter.filterBar.labelWarningText",defaultMessage:"Warning"});label.message=props.intl.formatMessage({id:"data.filter.filterBar.labelWarningInfo",defaultMessage:"Field {fieldName} does not exist in current view"},{fieldName:filter.meta.key})}return label}if(indexPatternExists===undefined)return null;var valueLabelConfig=getValueLabel();if(valueLabelConfig.status===FILTER_ITEM_ERROR&&!filter.meta.disabled){filter.meta.disabled=true;props.onUpdate(filter);return null}var badge=external_kbnSharedDeps_React_default.a.createElement(filter_view_FilterView,{filter:filter,valueLabel:valueLabelConfig.title,filterLabelStatus:valueLabelConfig.status,errorMessage:valueLabelConfig.message,className:getClasses(filter.meta.negate,valueLabelConfig),iconOnClick:function iconOnClick(){return props.onRemove()},onClick:handleBadgeClick,"data-test-subj":getDataTestSubj(valueLabelConfig)});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"popoverFor_filter".concat(id),className:"globalFilterItem__popover",anchorClassName:"globalFilterItem__popoverAnchor",isOpen:isPopoverOpen,closePopover:function closePopover(){setIsPopoverOpen(false)},button:badge,anchorPosition:"downLeft",withTitle:true,panelPaddingSize:"none"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenu"],{initialPanelId:0,panels:getPanels()}))}function filter_options_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function filter_options_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function filter_options_createClass(Constructor,protoProps,staticProps){if(protoProps)filter_options_defineProperties(Constructor.prototype,protoProps);if(staticProps)filter_options_defineProperties(Constructor,staticProps);return Constructor}function filter_options_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)filter_options_setPrototypeOf(subClass,superClass)}function filter_options_setPrototypeOf(o,p){filter_options_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return filter_options_setPrototypeOf(o,p)}function filter_options_createSuper(Derived){var hasNativeReflectConstruct=filter_options_isNativeReflectConstruct();return function _createSuperInternal(){var Super=filter_options_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=filter_options_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return filter_options_possibleConstructorReturn(this,result)}}function filter_options_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return filter_options_assertThisInitialized(self)}function filter_options_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function filter_options_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function filter_options_getPrototypeOf(o){filter_options_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return filter_options_getPrototypeOf(o)}function filter_options_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var filter_options_FilterOptionsUI=function(_Component){filter_options_inherits(FilterOptionsUI,_Component);var _super=filter_options_createSuper(FilterOptionsUI);function FilterOptionsUI(){var _this;filter_options_classCallCheck(this,FilterOptionsUI);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));filter_options_defineProperty(filter_options_assertThisInitialized(_this),"state",{isPopoverOpen:false});filter_options_defineProperty(filter_options_assertThisInitialized(_this),"togglePopover",(function(){_this.setState((function(prevState){return{isPopoverOpen:!prevState.isPopoverOpen}}))}));filter_options_defineProperty(filter_options_assertThisInitialized(_this),"closePopover",(function(){_this.setState({isPopoverOpen:false})}));return _this}filter_options_createClass(FilterOptionsUI,[{key:"render",value:function render(){var _this2=this;var panelTree={id:0,items:[{name:this.props.intl.formatMessage({id:"data.filter.options.enableAllFiltersButtonLabel",defaultMessage:"Enable all"}),icon:"eye",onClick:function onClick(){_this2.closePopover();_this2.props.onEnableAll()},"data-test-subj":"enableAllFilters"},{name:this.props.intl.formatMessage({id:"data.filter.options.disableAllFiltersButtonLabel",defaultMessage:"Disable all"}),icon:"eyeClosed",onClick:function onClick(){_this2.closePopover();_this2.props.onDisableAll()},"data-test-subj":"disableAllFilters"},{name:this.props.intl.formatMessage({id:"data.filter.options.pinAllFiltersButtonLabel",defaultMessage:"Pin all"}),icon:"pin",onClick:function onClick(){_this2.closePopover();_this2.props.onPinAll()},"data-test-subj":"pinAllFilters"},{name:this.props.intl.formatMessage({id:"data.filter.options.unpinAllFiltersButtonLabel",defaultMessage:"Unpin all"}),icon:"pin",onClick:function onClick(){_this2.closePopover();_this2.props.onUnpinAll()},"data-test-subj":"unpinAllFilters"},{name:this.props.intl.formatMessage({id:"data.filter.options.invertNegatedFiltersButtonLabel",defaultMessage:"Invert inclusion"}),icon:"invert",onClick:function onClick(){_this2.closePopover();_this2.props.onToggleAllNegated()},"data-test-subj":"invertInclusionAllFilters"},{name:this.props.intl.formatMessage({id:"data.filter.options.invertDisabledFiltersButtonLabel",defaultMessage:"Invert enabled/disabled"}),icon:"eye",onClick:function onClick(){_this2.closePopover();_this2.props.onToggleAllDisabled()},"data-test-subj":"invertEnableDisableAllFilters"},{name:this.props.intl.formatMessage({id:"data.filter.options.deleteAllFiltersButtonLabel",defaultMessage:"Remove all"}),icon:"trash",onClick:function onClick(){_this2.closePopover();_this2.props.onRemoveAll()},"data-test-subj":"removeAllFilters"}]};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"popoverForAllFilters",className:"globalFilterGroup__allFiltersPopover",isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,button:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonIcon"],{onClick:this.togglePopover,iconType:"filter","aria-label":this.props.intl.formatMessage({id:"data.filter.options.changeAllFiltersButtonLabel",defaultMessage:"Change all filters"}),title:this.props.intl.formatMessage({id:"data.filter.options.changeAllFiltersButtonLabel",defaultMessage:"Change all filters"}),"data-test-subj":"showFilterActions"}),anchorPosition:"rightUp",panelPaddingSize:"none",withTitle:true,repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.searchBar.changeAllFiltersTitle",defaultMessage:"Change all filters"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiContextMenu"],{initialPanelId:0,panels:[panelTree]}))}}]);return FilterOptionsUI}(external_kbnSharedDeps_React_["Component"]);var FilterOptions=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(filter_options_FilterOptionsUI);function filter_bar_toConsumableArray(arr){return filter_bar_arrayWithoutHoles(arr)||filter_bar_iterableToArray(arr)||filter_bar_unsupportedIterableToArray(arr)||filter_bar_nonIterableSpread()}function filter_bar_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_bar_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function filter_bar_arrayWithoutHoles(arr){if(Array.isArray(arr))return filter_bar_arrayLikeToArray(arr)}function filter_bar_slicedToArray(arr,i){return filter_bar_arrayWithHoles(arr)||filter_bar_iterableToArrayLimit(arr,i)||filter_bar_unsupportedIterableToArray(arr,i)||filter_bar_nonIterableRest()}function filter_bar_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function filter_bar_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return filter_bar_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return filter_bar_arrayLikeToArray(o,minLen)}function filter_bar_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function filter_bar_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function filter_bar_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function FilterBarUI(props){var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=filter_bar_slicedToArray(_useState,2),isAddFilterPopoverOpen=_useState2[0],setIsAddFilterPopoverOpen=_useState2[1];var kibana=Object(kibana_react_public["useKibana"])();var uiSettings=kibana.services.uiSettings;if(!uiSettings)return null;function onFiltersUpdated(filters){if(props.onFiltersUpdated){props.onFiltersUpdated(filters)}}function renderItems(){return props.filters.map((function(filter,i){return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{key:i,grow:false,className:"globalFilterBar__flexItem"},external_kbnSharedDeps_React_default.a.createElement(FilterItem,{id:"".concat(i),intl:props.intl,filter:filter,onUpdate:function onUpdate(newFilter){return _onUpdate(i,newFilter)},onRemove:function onRemove(){return _onRemove(i)},indexPatterns:props.indexPatterns,uiSettings:uiSettings}))}))}function renderAddFilter(){var isPinned=uiSettings.get(common["UI_SETTINGS"].FILTERS_PINNED_BY_DEFAULT);var _props$indexPatterns=filter_bar_slicedToArray(props.indexPatterns,1),indexPattern=_props$indexPatterns[0];var index=indexPattern&&indexPattern.id;var newFilter=Object(common["buildEmptyFilter"])(isPinned,index);var button=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",onClick:function onClick(){return setIsAddFilterPopoverOpen(true)},"data-test-subj":"addFilter",className:"globalFilterBar__addButton"},"+"," ",external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.filter.filterBar.addFilterButtonLabel",defaultMessage:"Add filter"}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"addFilterPopover",button:button,isOpen:isAddFilterPopoverOpen,closePopover:function closePopover(){return setIsAddFilterPopoverOpen(false)},anchorPosition:"downLeft",withTitle:true,panelPaddingSize:"none",ownFocus:true,initialFocus:".filterEditor__hiddenItem",repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement("div",{style:{width:400}},external_kbnSharedDeps_React_default.a.createElement(FilterEditor,{filter:newFilter,indexPatterns:props.indexPatterns,onSubmit:onAdd,onCancel:function onCancel(){return setIsAddFilterPopoverOpen(false)},key:JSON.stringify(newFilter)})))))}function onAdd(filter){setIsAddFilterPopoverOpen(false);var filters=[].concat(filter_bar_toConsumableArray(props.filters),[filter]);onFiltersUpdated(filters)}function _onRemove(i){var filters=filter_bar_toConsumableArray(props.filters);filters.splice(i,1);onFiltersUpdated(filters)}function _onUpdate(i,filter){var filters=filter_bar_toConsumableArray(props.filters);filters[i]=filter;onFiltersUpdated(filters)}function onEnableAll(){var filters=props.filters.map(common["enableFilter"]);onFiltersUpdated(filters)}function onDisableAll(){var filters=props.filters.map(common["disableFilter"]);onFiltersUpdated(filters)}function onPinAll(){var filters=props.filters.map(common["pinFilter"]);onFiltersUpdated(filters)}function onUnpinAll(){var filters=props.filters.map(common["unpinFilter"]);onFiltersUpdated(filters)}function onToggleAllNegated(){var filters=props.filters.map(common["toggleFilterNegated"]);onFiltersUpdated(filters)}function onToggleAllDisabled(){var filters=props.filters.map(common["toggleFilterDisabled"]);onFiltersUpdated(filters)}function onRemoveAll(){onFiltersUpdated([])}var classes=classnames_default()("globalFilterBar",props.className);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:"globalFilterGroup",gutterSize:"none",alignItems:"flexStart",responsive:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"globalFilterGroup__branch",grow:false},external_kbnSharedDeps_React_default.a.createElement(FilterOptions,{onEnableAll:onEnableAll,onDisableAll:onDisableAll,onPinAll:onPinAll,onUnpinAll:onUnpinAll,onToggleAllNegated:onToggleAllNegated,onToggleAllDisabled:onToggleAllDisabled,onRemoveAll:onRemoveAll})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:"globalFilterGroup__filterFlexItem"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:classes,wrap:true,responsive:false,gutterSize:"xs",alignItems:"center"},renderItems(),renderAddFilter())))}var FilterBar=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(FilterBarUI);function save_query_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function save_query_form_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){save_query_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){save_query_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function save_query_form_slicedToArray(arr,i){return save_query_form_arrayWithHoles(arr)||save_query_form_iterableToArrayLimit(arr,i)||save_query_form_unsupportedIterableToArray(arr,i)||save_query_form_nonIterableRest()}function save_query_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function save_query_form_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return save_query_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return save_query_form_arrayLikeToArray(o,minLen)}function save_query_form_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function save_query_form_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function save_query_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}function SaveQueryForm(_ref){var savedQuery=_ref.savedQuery,savedQueryService=_ref.savedQueryService,onSave=_ref.onSave,onClose=_ref.onClose,_ref$showFilterOption=_ref.showFilterOption,showFilterOption=_ref$showFilterOption===void 0?true:_ref$showFilterOption,_ref$showTimeFilterOp=_ref.showTimeFilterOption,showTimeFilterOption=_ref$showTimeFilterOp===void 0?true:_ref$showTimeFilterOp;var _useState=Object(external_kbnSharedDeps_React_["useState"])(savedQuery?savedQuery.title:""),_useState2=save_query_form_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(Boolean(savedQuery)),_useState4=save_query_form_slicedToArray(_useState3,2),enabledSaveButton=_useState4[0],setEnabledSaveButton=_useState4[1];var _useState5=Object(external_kbnSharedDeps_React_["useState"])(savedQuery?savedQuery.description:""),_useState6=save_query_form_slicedToArray(_useState5,2),description=_useState6[0],setDescription=_useState6[1];var _useState7=Object(external_kbnSharedDeps_React_["useState"])([]),_useState8=save_query_form_slicedToArray(_useState7,2),savedQueries=_useState8[0],setSavedQueries=_useState8[1];var _useState9=Object(external_kbnSharedDeps_React_["useState"])(savedQuery?!!savedQuery.filters:true),_useState10=save_query_form_slicedToArray(_useState9,2),shouldIncludeFilters=_useState10[0],setShouldIncludeFilters=_useState10[1];var _useState11=Object(external_kbnSharedDeps_React_["useState"])(savedQuery?!!savedQuery.timefilter:false),_useState12=save_query_form_slicedToArray(_useState11,2),shouldIncludeTimefilter=_useState12[0],setIncludeTimefilter=_useState12[1];var _useState13=Object(external_kbnSharedDeps_React_["useState"])([]),_useState14=save_query_form_slicedToArray(_useState13,2),formErrors=_useState14[0],setFormErrors=_useState14[1];var titleConflictErrorText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryForm.titleConflictText",{defaultMessage:"Name conflicts with an existing saved query"});var savedQueryDescriptionText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryDescriptionText",{defaultMessage:"Save query text and filters that you want to use again."});Object(external_kbnSharedDeps_React_["useEffect"])((function(){var fetchQueries=function(){var _ref2=save_query_form_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var allSavedQueries,sortedAllSavedQueries;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return savedQueryService.getAllSavedQueries();case 2:allSavedQueries=_context.sent;sortedAllSavedQueries=Object(external_kbnSharedDeps_Lodash_["sortBy"])(allSavedQueries,"attributes.title");setSavedQueries(sortedAllSavedQueries);case 5:case"end":return _context.stop()}}}),_callee)})));return function fetchQueries(){return _ref2.apply(this,arguments)}}();fetchQueries()}),[savedQueryService]);var validate=Object(external_kbnSharedDeps_React_["useCallback"])((function(){var errors=[];if(!!savedQueries.find((function(existingSavedQuery){return!savedQuery&&existingSavedQuery.attributes.title===title}))){errors.push(titleConflictErrorText)}if(!Object(external_kbnSharedDeps_Lodash_["isEqual"])(errors,formErrors)){setFormErrors(errors);return false}return!formErrors.length}),[savedQueries,savedQuery,title,titleConflictErrorText,formErrors]);var onClickSave=Object(external_kbnSharedDeps_React_["useCallback"])((function(){if(validate()){onSave({title:title,description:description,shouldIncludeFilters:shouldIncludeFilters,shouldIncludeTimefilter:shouldIncludeTimefilter})}}),[validate,onSave,title,description,shouldIncludeFilters,shouldIncludeTimefilter]);var onInputChange=Object(external_kbnSharedDeps_React_["useCallback"])((function(event){setEnabledSaveButton(Boolean(event.target.value));setFormErrors([]);setTitle(event.target.value)}),[]);var autoTrim=Object(external_kbnSharedDeps_React_["useCallback"])((function(){var trimmedTitle=title.trim();if(title.length>trimmedTitle.length){setTitle(trimmedTitle)}}),[title]);var hasErrors=formErrors.length>0;var saveQueryForm=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiForm"],{isInvalid:hasErrors,error:formErrors,"data-test-subj":"saveQueryForm"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{color:"subdued"},savedQueryDescriptionText)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryNameLabelText",{defaultMessage:"Name"}),helpText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryNameHelpText",{defaultMessage:"Name is required. Name cannot contain leading or trailing whitespace. Name must be unique."}),isInvalid:hasErrors},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{disabled:!!savedQuery,value:title,name:"title",onChange:onInputChange,"data-test-subj":"saveQueryFormTitle",isInvalid:hasErrors,onBlur:autoTrim})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],{label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryDescriptionLabelText",{defaultMessage:"Description"})},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFieldText"],{value:description,name:"description",onChange:function onChange(event){setDescription(event.target.value)},"data-test-subj":"saveQueryFormDescription"})),showFilterOption&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"shouldIncludeFilters",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryIncludeFiltersLabelText",{defaultMessage:"Include filters"}),checked:shouldIncludeFilters,onChange:function onChange(){setShouldIncludeFilters(!shouldIncludeFilters)},"data-test-subj":"saveQueryFormIncludeFiltersOption"})),showTimeFilterOption&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFormRow"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSwitch"],{name:"shouldIncludeTimefilter",label:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryIncludeTimeFilterLabelText",{defaultMessage:"Include time filter"}),checked:shouldIncludeTimefilter,onChange:function onChange(){setIncludeTimefilter(!shouldIncludeTimefilter)},"data-test-subj":"saveQueryFormIncludeTimeFilterOption"})));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModal"],{onClose:onClose,initialFocus:"[name=title]"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeader"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalHeaderTitle"],null,external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryFormTitle",{defaultMessage:"Save query"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalBody"],null,saveQueryForm),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiModalFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:onClose,"data-test-subj":"savedQueryFormCancelButton"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryFormCancelButtonText",{defaultMessage:"Cancel"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{onClick:onClickSave,fill:true,"data-test-subj":"savedQueryFormSaveButton",disabled:hasErrors||!enabledSaveButton},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryFormSaveButtonText",{defaultMessage:"Save"})))))}function saved_query_list_item_slicedToArray(arr,i){return saved_query_list_item_arrayWithHoles(arr)||saved_query_list_item_iterableToArrayLimit(arr,i)||saved_query_list_item_unsupportedIterableToArray(arr,i)||saved_query_list_item_nonIterableRest()}function saved_query_list_item_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function saved_query_list_item_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return saved_query_list_item_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return saved_query_list_item_arrayLikeToArray(o,minLen)}function saved_query_list_item_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function saved_query_list_item_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function saved_query_list_item_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var saved_query_list_item_SavedQueryListItem=function SavedQueryListItem(_ref){var savedQuery=_ref.savedQuery,isSelected=_ref.isSelected,onSelect=_ref.onSelect,onDelete=_ref.onDelete,showWriteOperations=_ref.showWriteOperations;var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=saved_query_list_item_slicedToArray(_useState,2),showDeletionConfirmationModal=_useState2[0],setShowDeletionConfirmationModal=_useState2[1];var selectButtonAriaLabelText=isSelected?external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSavedQueryListItemSelectedButtonAriaLabel",{defaultMessage:"Saved query button selected {savedQueryName}. Press to clear any changes.",values:{savedQueryName:savedQuery.attributes.title}}):external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSavedQueryListItemButtonAriaLabel",{defaultMessage:"Saved query button {savedQueryName}",values:{savedQueryName:savedQuery.attributes.title}});var selectButtonDataTestSubj=isSelected?"load-saved-query-".concat(savedQuery.attributes.title,"-button saved-query-list-item-selected"):"load-saved-query-".concat(savedQuery.attributes.title,"-button");var classes=classnames_default()("kbnSavedQueryListItem",{"kbnSavedQueryListItem-selected":isSelected});var label=external_kbnSharedDeps_React_default.a.createElement("span",{className:"kbnSavedQueryListItem__label"},external_kbnSharedDeps_React_default.a.createElement("span",{className:"kbnSavedQueryListItem__labelText"},savedQuery.attributes.title)," ",savedQuery.attributes.description&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIconTip"],{type:"iInCircle",content:savedQuery.attributes.description,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSavedQueryListItemDescriptionAriaLabel",{defaultMessage:"{savedQueryName} description",values:{savedQueryName:savedQuery.attributes.title}})}));return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiListGroupItem"],{className:classes,key:savedQuery.id,"data-test-subj":"saved-query-list-item ".concat(selectButtonDataTestSubj," ").concat(isSelected?"saved-query-list-item-selected":""),isActive:isSelected,onClick:function onClick(){onSelect(savedQuery)},"aria-label":selectButtonAriaLabelText,label:label,iconType:isSelected?"check":undefined,extraAction:showWriteOperations?{color:"danger",onClick:function onClick(){return setShowDeletionConfirmationModal(true)},iconType:"trash",iconSize:"s","aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverDeleteButtonAriaLabel",{defaultMessage:"Delete saved query {savedQueryName}",values:{savedQueryName:savedQuery.attributes.title}}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverDeleteButtonAriaLabel",{defaultMessage:"Delete saved query {savedQueryName}",values:{savedQueryName:savedQuery.attributes.title}}),"data-test-subj":"delete-saved-query-".concat(savedQuery.attributes.title,"-button")}:undefined}),showDeletionConfirmationModal&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiOverlayMask"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiConfirmModal"],{title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverConfirmDeletionTitle",{defaultMessage:'Delete "{savedQueryName}"?',values:{savedQueryName:savedQuery.attributes.title}}),confirmButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverConfirmDeletionConfirmButtonText",{defaultMessage:"Delete"}),cancelButtonText:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverConfirmDeletionCancelButtonText",{defaultMessage:"Cancel"}),onConfirm:function onConfirm(){onDelete(savedQuery);setShowDeletionConfirmationModal(false)},buttonColor:"danger",onCancel:function onCancel(){setShowDeletionConfirmationModal(false)}})))};function saved_query_management_component_toConsumableArray(arr){return saved_query_management_component_arrayWithoutHoles(arr)||saved_query_management_component_iterableToArray(arr)||saved_query_management_component_unsupportedIterableToArray(arr)||saved_query_management_component_nonIterableSpread()}function saved_query_management_component_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function saved_query_management_component_iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function saved_query_management_component_arrayWithoutHoles(arr){if(Array.isArray(arr))return saved_query_management_component_arrayLikeToArray(arr)}function saved_query_management_component_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function saved_query_management_component_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){saved_query_management_component_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){saved_query_management_component_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function saved_query_management_component_slicedToArray(arr,i){return saved_query_management_component_arrayWithHoles(arr)||saved_query_management_component_iterableToArrayLimit(arr,i)||saved_query_management_component_unsupportedIterableToArray(arr,i)||saved_query_management_component_nonIterableRest()}function saved_query_management_component_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function saved_query_management_component_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return saved_query_management_component_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return saved_query_management_component_arrayLikeToArray(o,minLen)}function saved_query_management_component_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function saved_query_management_component_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function saved_query_management_component_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var perPage=50;function SavedQueryManagementComponent(_ref){var showSaveQuery=_ref.showSaveQuery,loadedSavedQuery=_ref.loadedSavedQuery,onSave=_ref.onSave,onSaveAsNew=_ref.onSaveAsNew,onLoad=_ref.onLoad,onClearSavedQuery=_ref.onClearSavedQuery,savedQueryService=_ref.savedQueryService;var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=saved_query_management_component_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])([]),_useState4=saved_query_management_component_slicedToArray(_useState3,2),savedQueries=_useState4[0],setSavedQueries=_useState4[1];var _useState5=Object(external_kbnSharedDeps_React_["useState"])(0),_useState6=saved_query_management_component_slicedToArray(_useState5,2),count=_useState6[0],setTotalCount=_useState6[1];var _useState7=Object(external_kbnSharedDeps_React_["useState"])(0),_useState8=saved_query_management_component_slicedToArray(_useState7,2),activePage=_useState8[0],setActivePage=_useState8[1];var cancelPendingListingRequest=Object(external_kbnSharedDeps_React_["useRef"])((function(){}));Object(external_kbnSharedDeps_React_["useEffect"])((function(){var fetchCountAndSavedQueries=function(){var _ref2=saved_query_management_component_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var requestGotCancelled,_yield$savedQueryServ,savedQueryCount,savedQueryItems,sortedSavedQueryItems;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:cancelPendingListingRequest.current();requestGotCancelled=false;cancelPendingListingRequest.current=function(){requestGotCancelled=true};_context.next=5;return savedQueryService.findSavedQueries("",perPage,activePage+1);case 5:_yield$savedQueryServ=_context.sent;savedQueryCount=_yield$savedQueryServ.total;savedQueryItems=_yield$savedQueryServ.queries;if(!requestGotCancelled){_context.next=10;break}return _context.abrupt("return");case 10:sortedSavedQueryItems=Object(external_kbnSharedDeps_Lodash_["sortBy"])(savedQueryItems,"attributes.title");setTotalCount(savedQueryCount);setSavedQueries(sortedSavedQueryItems);case 13:case"end":return _context.stop()}}}),_callee)})));return function fetchCountAndSavedQueries(){return _ref2.apply(this,arguments)}}();if(isOpen){fetchCountAndSavedQueries()}}),[isOpen,activePage,savedQueryService]);var handleTogglePopover=Object(external_kbnSharedDeps_React_["useCallback"])((function(){return setIsOpen((function(currentState){return!currentState}))}),[setIsOpen]);var handleClosePopover=Object(external_kbnSharedDeps_React_["useCallback"])((function(){return setIsOpen(false)}),[]);var handleSave=Object(external_kbnSharedDeps_React_["useCallback"])((function(){handleClosePopover();onSave()}),[handleClosePopover,onSave]);var handleSaveAsNew=Object(external_kbnSharedDeps_React_["useCallback"])((function(){handleClosePopover();onSaveAsNew()}),[handleClosePopover,onSaveAsNew]);var handleSelect=Object(external_kbnSharedDeps_React_["useCallback"])((function(savedQueryToSelect){handleClosePopover();onLoad(savedQueryToSelect)}),[handleClosePopover,onLoad]);var handleDelete=Object(external_kbnSharedDeps_React_["useCallback"])((function(savedQueryToDelete){var onDeleteSavedQuery=function(){var _ref3=saved_query_management_component_asyncToGenerator(regeneratorRuntime.mark((function _callee2(savedQuery){return regeneratorRuntime.wrap((function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:cancelPendingListingRequest.current();setSavedQueries(savedQueries.filter((function(currentSavedQuery){return currentSavedQuery.id!==savedQuery.id})));if(loadedSavedQuery&&loadedSavedQuery.id===savedQuery.id){onClearSavedQuery()}_context2.next=5;return savedQueryService.deleteSavedQuery(savedQuery.id);case 5:setActivePage(0);case 6:case"end":return _context2.stop()}}}),_callee2)})));return function onDeleteSavedQuery(_x){return _ref3.apply(this,arguments)}}();onDeleteSavedQuery(savedQueryToDelete);handleClosePopover()}),[handleClosePopover,loadedSavedQuery,onClearSavedQuery,savedQueries,savedQueryService]);var savedQueryDescriptionText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryDescriptionText",{defaultMessage:"Save query text and filters that you want to use again."});var noSavedQueriesDescriptionText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryNoSavedQueriesText",{defaultMessage:"There are no saved queries."})+" "+savedQueryDescriptionText;var savedQueryPopoverTitleText=external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverTitleText",{defaultMessage:"Saved Queries"});var goToPage=function goToPage(pageNumber){setActivePage(pageNumber)};var savedQueryPopoverButton=external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{onClick:handleTogglePopover,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverButtonText",{defaultMessage:"See saved queries"}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverButtonText",{defaultMessage:"See saved queries"}),"data-test-subj":"saved-query-management-popover-button"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"save",className:"euiQuickSelectPopover__buttonText"}),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiIcon"],{type:"arrowDown"}));var savedQueryRows=function savedQueryRows(){var savedQueriesWithoutCurrent=savedQueries.filter((function(savedQuery){if(!loadedSavedQuery)return true;return savedQuery.id!==loadedSavedQuery.id}));var savedQueriesReordered=loadedSavedQuery&&savedQueriesWithoutCurrent.length!==savedQueries.length?[loadedSavedQuery].concat(saved_query_management_component_toConsumableArray(savedQueriesWithoutCurrent)):saved_query_management_component_toConsumableArray(savedQueriesWithoutCurrent);return savedQueriesReordered.map((function(savedQuery){return external_kbnSharedDeps_React_default.a.createElement(saved_query_list_item_SavedQueryListItem,{key:savedQuery.id,savedQuery:savedQuery,isSelected:!!loadedSavedQuery&&loadedSavedQuery.id===savedQuery.id,onSelect:handleSelect,onDelete:handleDelete,showWriteOperations:!!showSaveQuery})}))};return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopover"],{id:"savedQueryPopover",button:savedQueryPopoverButton,isOpen:isOpen,closePopover:handleClosePopover,anchorPosition:"downLeft",panelPaddingSize:"none",buffer:-8,ownFocus:true,repositionOnScroll:true},external_kbnSharedDeps_React_default.a.createElement("div",{className:"kbnSavedQueryManagement__popover","data-test-subj":"saved-query-management-popover"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverTitle"],{id:"savedQueryManagementPopoverTitle"},savedQueryPopoverTitleText),savedQueries.length>0?external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued",className:"kbnSavedQueryManagement__text"},external_kbnSharedDeps_React_default.a.createElement("p",null,savedQueryDescriptionText)),external_kbnSharedDeps_React_default.a.createElement("div",{className:"kbnSavedQueryManagement__listWrapper"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiListGroup"],{flush:true,className:"kbnSavedQueryManagement__list","aria-labelledby":"savedQueryManagementPopoverTitle"},savedQueryRows())),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPagination"],{className:"kbnSavedQueryManagement__pagination",pageCount:Math.ceil(count/perPage),activePage:activePage,onPageClick:goToPage})):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s",color:"subdued",className:"kbnSavedQueryManagement__text"},external_kbnSharedDeps_React_default.a.createElement("p",null,noSavedQueriesDescriptionText)),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSpacer"],{size:"s"})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiPopoverFooter"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{direction:"rowReverse",gutterSize:"s",alignItems:"center",justifyContent:"flexEnd",responsive:false,wrap:true},showSaveQuery&&loadedSavedQuery&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_React_["Fragment"],null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",fill:true,onClick:handleSave,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSaveChangesButtonAriaLabel",{defaultMessage:"Save changes to {title}",values:{title:loadedSavedQuery.attributes.title}}),"data-test-subj":"saved-query-management-save-changes-button"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSaveChangesButtonText",{defaultMessage:"Save changes"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",onClick:handleSaveAsNew,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSaveAsNewButtonAriaLabel",{defaultMessage:"Save as new saved query"}),"data-test-subj":"saved-query-management-save-as-new-button"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSaveAsNewButtonText",{defaultMessage:"Save as new"})))),showSaveQuery&&!loadedSavedQuery&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",fill:true,onClick:handleSave,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSaveButtonAriaLabel",{defaultMessage:"Save a new saved query"}),"data-test-subj":"saved-query-management-save-button"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverSaveButtonText",{defaultMessage:"Save current query"}))),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},loadedSavedQuery&&external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"s",flush:"left",onClick:onClearSavedQuery,"aria-label":external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverClearButtonAriaLabel",{defaultMessage:"Clear current saved query"}),"data-test-subj":"saved-query-management-clear-button"},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.search.searchBar.savedQueryPopoverClearButtonText",{defaultMessage:"Clear"}))))))))}function search_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function search_bar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){search_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){search_bar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)}))}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}));keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach((function(key){search_bar_defineProperty(target,key,source[key])}))}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}}return target}function search_bar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function search_bar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function search_bar_createClass(Constructor,protoProps,staticProps){if(protoProps)search_bar_defineProperties(Constructor.prototype,protoProps);if(staticProps)search_bar_defineProperties(Constructor,staticProps);return Constructor}function search_bar_inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)search_bar_setPrototypeOf(subClass,superClass)}function search_bar_setPrototypeOf(o,p){search_bar_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return search_bar_setPrototypeOf(o,p)}function search_bar_createSuper(Derived){var hasNativeReflectConstruct=search_bar_isNativeReflectConstruct();return function _createSuperInternal(){var Super=search_bar_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=search_bar_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return search_bar_possibleConstructorReturn(this,result)}}function search_bar_possibleConstructorReturn(self,call){if(call&&(typeof call==="object"||typeof call==="function")){return call}return search_bar_assertThisInitialized(self)}function search_bar_assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function search_bar_isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],(function(){})));return true}catch(e){return false}}function search_bar_getPrototypeOf(o){search_bar_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return search_bar_getPrototypeOf(o)}function search_bar_defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var search_bar_SearchBarUI=function(_Component){search_bar_inherits(SearchBarUI,_Component);var _super=search_bar_createSuper(SearchBarUI);function SearchBarUI(){var _this;search_bar_classCallCheck(this,SearchBarUI);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_super.call.apply(_super,[this].concat(args));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"services",_this.props.kibana.services);search_bar_defineProperty(search_bar_assertThisInitialized(_this),"savedQueryService",_this.services.data.query.savedQueries);search_bar_defineProperty(search_bar_assertThisInitialized(_this),"filterBarRef",null);search_bar_defineProperty(search_bar_assertThisInitialized(_this),"filterBarWrapperRef",null);search_bar_defineProperty(search_bar_assertThisInitialized(_this),"state",{isFiltersVisible:true,showSaveQueryModal:false,showSaveNewQueryModal:false,showSavedQueryPopover:false,currentProps:_this.props,query:_this.props.query?_objectSpread({},_this.props.query):undefined,dateRangeFrom:Object(external_kbnSharedDeps_Lodash_["get"])(_this.props,"dateRangeFrom","now-15m"),dateRangeTo:Object(external_kbnSharedDeps_Lodash_["get"])(_this.props,"dateRangeTo","now")});search_bar_defineProperty(search_bar_assertThisInitialized(_this),"isDirty",(function(){if(!_this.props.showDatePicker&&_this.state.query&&_this.props.query){return _this.state.query.query!==_this.props.query.query}return _this.state.query&&_this.props.query&&_this.state.query.query!==_this.props.query.query||_this.state.dateRangeFrom!==_this.props.dateRangeFrom||_this.state.dateRangeTo!==_this.props.dateRangeTo}));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"setFilterBarHeight",(function(){requestAnimationFrame((function(){var height=_this.filterBarRef&&_this.state.isFiltersVisible?_this.filterBarRef.clientHeight:0;if(_this.filterBarWrapperRef){_this.filterBarWrapperRef.setAttribute("style","height: ".concat(height,"px"))}}))}));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"ro",new ResizeObserver_default.a(_this.setFilterBarHeight));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"onSave",function(){var _ref=search_bar_asyncToGenerator(regeneratorRuntime.mark((function _callee(savedQueryMeta){var saveAsNew,savedQueryAttributes,response,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:saveAsNew=_args.length>1&&_args[1]!==undefined?_args[1]:false;if(_this.state.query){_context.next=3;break}return _context.abrupt("return");case 3:savedQueryAttributes={title:savedQueryMeta.title,description:savedQueryMeta.description,query:_this.state.query};if(savedQueryMeta.shouldIncludeFilters){savedQueryAttributes.filters=_this.props.filters}if(savedQueryMeta.shouldIncludeTimefilter&&_this.state.dateRangeTo!==undefined&&_this.state.dateRangeFrom!==undefined&&_this.props.refreshInterval!==undefined&&_this.props.isRefreshPaused!==undefined){savedQueryAttributes.timefilter={from:_this.state.dateRangeFrom,to:_this.state.dateRangeTo,refreshInterval:{value:_this.props.refreshInterval,pause:_this.props.isRefreshPaused}}}_context.prev=6;if(!(_this.props.savedQuery&&!saveAsNew)){_context.next=13;break}_context.next=10;return _this.savedQueryService.saveQuery(savedQueryAttributes,{overwrite:true});case 10:response=_context.sent;_context.next=16;break;case 13:_context.next=15;return _this.savedQueryService.saveQuery(savedQueryAttributes);case 15:response=_context.sent;case 16:_this.services.notifications.toasts.addSuccess('Your query "'.concat(response.attributes.title,'" was saved'));_this.setState({showSaveQueryModal:false,showSaveNewQueryModal:false});if(_this.props.onSaved){_this.props.onSaved(response)}_context.next=25;break;case 21:_context.prev=21;_context.t0=_context["catch"](6);_this.services.notifications.toasts.addDanger("An error occured while saving your query: ".concat(_context.t0.message));throw _context.t0;case 25:case"end":return _context.stop()}}}),_callee,null,[[6,21]])})));return function(_x){return _ref.apply(this,arguments)}}());search_bar_defineProperty(search_bar_assertThisInitialized(_this),"onInitiateSave",(function(){_this.setState({showSaveQueryModal:true})}));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"onInitiateSaveNew",(function(){_this.setState({showSaveNewQueryModal:true})}));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"onQueryBarChange",(function(queryAndDateRange){_this.setState({query:queryAndDateRange.query,dateRangeFrom:queryAndDateRange.dateRange.from,dateRangeTo:queryAndDateRange.dateRange.to});if(_this.props.onQueryChange){_this.props.onQueryChange(queryAndDateRange)}}));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"onQueryBarSubmit",(function(queryAndDateRange){_this.setState({query:queryAndDateRange.query,dateRangeFrom:queryAndDateRange.dateRange&&queryAndDateRange.dateRange.from||_this.state.dateRangeFrom,dateRangeTo:queryAndDateRange.dateRange&&queryAndDateRange.dateRange.to||_this.state.dateRangeTo},(function(){if(_this.props.onQuerySubmit){_this.props.onQuerySubmit({query:_this.state.query,dateRange:{from:_this.state.dateRangeFrom,to:_this.state.dateRangeTo}})}}))}));search_bar_defineProperty(search_bar_assertThisInitialized(_this),"onLoadSavedQuery",(function(savedQuery){var dateRangeFrom=Object(external_kbnSharedDeps_Lodash_["get"])(savedQuery,"attributes.timefilter.from",_this.state.dateRangeFrom);var dateRangeTo=Object(external_kbnSharedDeps_Lodash_["get"])(savedQuery,"attributes.timefilter.to",_this.state.dateRangeTo);_this.setState({query:savedQuery.attributes.query,dateRangeFrom:dateRangeFrom,dateRangeTo:dateRangeTo});if(_this.props.onSavedQueryUpdated){_this.props.onSavedQueryUpdated(savedQuery)}}));return _this}search_bar_createClass(SearchBarUI,[{key:"shouldRenderQueryBar",value:function shouldRenderQueryBar(){var showDatePicker=this.props.showDatePicker||this.props.showAutoRefreshOnly;var showQueryInput=this.props.showQueryInput&&this.props.indexPatterns&&this.state.query;return this.props.showQueryBar&&(showDatePicker||showQueryInput)}},{key:"shouldRenderFilterBar",value:function shouldRenderFilterBar(){return this.props.showFilterBar&&this.props.filters&&this.props.indexPatterns&&Object(external_kbnSharedDeps_Lodash_["compact"])(this.props.indexPatterns).length>0}},{key:"shouldRenderTimeFilterInSavedQueryForm",value:function shouldRenderTimeFilterInSavedQueryForm(){var _this$props=this.props,dateRangeFrom=_this$props.dateRangeFrom,dateRangeTo=_this$props.dateRangeTo,showDatePicker=_this$props.showDatePicker;return showDatePicker||!showDatePicker&&dateRangeFrom!==undefined&&dateRangeTo!==undefined}},{key:"componentDidMount",value:function componentDidMount(){if(this.filterBarRef){this.setFilterBarHeight();this.ro.observe(this.filterBarRef)}}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(this.filterBarRef){this.setFilterBarHeight();this.ro.unobserve(this.filterBarRef)}}},{key:"render",value:function render(){var _this2=this;var savedQueryManagement=this.state.query&&this.props.onClearSavedQuery&&external_kbnSharedDeps_React_default.a.createElement(SavedQueryManagementComponent,{showSaveQuery:this.props.showSaveQuery,loadedSavedQuery:this.props.savedQuery,onSave:this.onInitiateSave,onSaveAsNew:this.onInitiateSaveNew,onLoad:this.onLoadSavedQuery,savedQueryService:this.savedQueryService,onClearSavedQuery:this.props.onClearSavedQuery});var queryBar;if(this.shouldRenderQueryBar()){queryBar=external_kbnSharedDeps_React_default.a.createElement(query_bar_top_row["default"],{timeHistory:this.props.timeHistory,query:this.state.query,screenTitle:this.props.screenTitle,onSubmit:this.onQueryBarSubmit,indexPatterns:this.props.indexPatterns,isLoading:this.props.isLoading,prepend:this.props.showFilterBar?savedQueryManagement:undefined,showDatePicker:this.props.showDatePicker,dateRangeFrom:this.state.dateRangeFrom,dateRangeTo:this.state.dateRangeTo,isRefreshPaused:this.props.isRefreshPaused,refreshInterval:this.props.refreshInterval,showAutoRefreshOnly:this.props.showAutoRefreshOnly,showQueryInput:this.props.showQueryInput,onRefresh:this.props.onRefresh,onRefreshChange:this.props.onRefreshChange,onChange:this.onQueryBarChange,isDirty:this.isDirty(),customSubmitButton:this.props.customSubmitButton?this.props.customSubmitButton:undefined,dataTestSubj:this.props.dataTestSubj,indicateNoData:this.props.indicateNoData})}var filterBar;if(this.shouldRenderFilterBar()){var filterGroupClasses=classnames_default()("globalFilterGroup__wrapper",{"globalFilterGroup__wrapper-isVisible":this.state.isFiltersVisible});filterBar=external_kbnSharedDeps_React_default.a.createElement("div",{id:"GlobalFilterGroup",ref:function ref(node){_this2.filterBarWrapperRef=node},className:filterGroupClasses},external_kbnSharedDeps_React_default.a.createElement("div",{ref:function ref(node){_this2.filterBarRef=node}},external_kbnSharedDeps_React_default.a.createElement(FilterBar,{className:"globalFilterGroup__filterBar",filters:this.props.filters,onFiltersUpdated:this.props.onFiltersUpdated,indexPatterns:this.props.indexPatterns})))}return external_kbnSharedDeps_React_default.a.createElement("div",{className:"globalQueryBar","data-test-subj":"globalQueryBar"},queryBar,filterBar,this.state.showSaveQueryModal?external_kbnSharedDeps_React_default.a.createElement(SaveQueryForm,{savedQuery:this.props.savedQuery?this.props.savedQuery.attributes:undefined,savedQueryService:this.savedQueryService,onSave:this.onSave,onClose:function onClose(){return _this2.setState({showSaveQueryModal:false})},showFilterOption:this.props.showFilterBar,showTimeFilterOption:this.shouldRenderTimeFilterInSavedQueryForm()}):null,this.state.showSaveNewQueryModal?external_kbnSharedDeps_React_default.a.createElement(SaveQueryForm,{savedQueryService:this.savedQueryService,onSave:function onSave(savedQueryMeta){return _this2.onSave(savedQueryMeta,true)},onClose:function onClose(){return _this2.setState({showSaveNewQueryModal:false})},showFilterOption:this.props.showFilterBar,showTimeFilterOption:this.shouldRenderTimeFilterInSavedQueryForm()}):null)}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,prevState){if(Object(external_kbnSharedDeps_Lodash_["isEqual"])(prevState.currentProps,nextProps)){return null}var nextQuery=null;if(nextProps.query&&nextProps.query.query!==Object(external_kbnSharedDeps_Lodash_["get"])(prevState,"currentProps.query.query")){nextQuery={query:nextProps.query.query,language:nextProps.query.language}}else if(nextProps.query&&prevState.query&&nextProps.query.language!==prevState.query.language){nextQuery={query:"",language:nextProps.query.language}}var nextDateRange=null;if(nextProps.dateRangeFrom!==Object(external_kbnSharedDeps_Lodash_["get"])(prevState,"currentProps.dateRangeFrom")||nextProps.dateRangeTo!==Object(external_kbnSharedDeps_Lodash_["get"])(prevState,"currentProps.dateRangeTo")){nextDateRange={dateRangeFrom:nextProps.dateRangeFrom,dateRangeTo:nextProps.dateRangeTo}}var nextState={currentProps:nextProps};if(nextQuery){nextState.query=nextQuery}if(nextDateRange){nextState.dateRangeFrom=nextDateRange.dateRangeFrom;nextState.dateRangeTo=nextDateRange.dateRangeTo}return nextState}}]);return SearchBarUI}(external_kbnSharedDeps_React_["Component"]);search_bar_defineProperty(search_bar_SearchBarUI,"defaultProps",{showQueryBar:true,showFilterBar:true,showDatePicker:true,showAutoRefreshOnly:false});var search_bar=__webpack_exports__["default"]=Object(external_kbnSharedDeps_KbnI18nReact_["injectI18n"])(Object(kibana_react_public["withKibana"])(search_bar_SearchBarUI))},444:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return isOneOfOperator}));__webpack_require__.d(__webpack_exports__,"b",(function(){return existsOperator}));__webpack_require__.d(__webpack_exports__,"a",(function(){return FILTER_OPERATORS}));var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(99);var _kbn_i18n__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__);var _common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(154);var isOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.isOperatorOptionLabel",{defaultMessage:"is"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].PHRASE,negate:false};var isNotOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.isNotOperatorOptionLabel",{defaultMessage:"is not"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].PHRASE,negate:true};var isOneOfOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.isOneOfOperatorOptionLabel",{defaultMessage:"is one of"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].PHRASES,negate:false,fieldTypes:["string","number","date","ip","geo_point","geo_shape"]};var isNotOneOfOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.isNotOneOfOperatorOptionLabel",{defaultMessage:"is not one of"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].PHRASES,negate:true,fieldTypes:["string","number","date","ip","geo_point","geo_shape"]};var isBetweenOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.isBetweenOperatorOptionLabel",{defaultMessage:"is between"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].RANGE,negate:false,fieldTypes:["number","date","ip"]};var isNotBetweenOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.isNotBetweenOperatorOptionLabel",{defaultMessage:"is not between"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].RANGE,negate:true,fieldTypes:["number","date","ip"]};var existsOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.existsOperatorOptionLabel",{defaultMessage:"exists"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].EXISTS,negate:false};var doesNotExistOperator={message:_kbn_i18n__WEBPACK_IMPORTED_MODULE_0__["i18n"].translate("data.filter.filterEditor.doesNotExistOperatorOptionLabel",{defaultMessage:"does not exist"}),type:_common_es_query_filters__WEBPACK_IMPORTED_MODULE_1__["FILTERS"].EXISTS,negate:true};var FILTER_OPERATORS=[isOperator,isNotOperator,isOneOfOperator,isNotOneOfOperator,isBetweenOperator,isNotBetweenOperator,existsOperator,doesNotExistOperator]},738:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,"default",(function(){return QueryBarTopRow}));var elastic_datemath=__webpack_require__(136);var elastic_datemath_default=__webpack_require__.n(elastic_datemath);var classnames=__webpack_require__(130);var classnames_default=__webpack_require__.n(classnames);var external_kbnSharedDeps_React_=__webpack_require__(2);var external_kbnSharedDeps_React_default=__webpack_require__.n(external_kbnSharedDeps_React_);var external_kbnSharedDeps_KbnI18n_=__webpack_require__(99);var external_kbnSharedDeps_ElasticEui_=__webpack_require__(98);var external_kbnSharedDeps_KbnI18nReact_=__webpack_require__(100);var kibana_react_public=__webpack_require__(124);var query_string_input=__webpack_require__(730);var common=__webpack_require__(118);var public_query=__webpack_require__(133);function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}var NO_DATA_POPOVER_STORAGE_KEY="data.noDataPopover";function NoDataPopover(_ref){var showNoDataPopover=_ref.showNoDataPopover,storage=_ref.storage,children=_ref.children;var _useState=Object(external_kbnSharedDeps_React_["useState"])((function(){return Boolean(storage.get(NO_DATA_POPOVER_STORAGE_KEY))})),_useState2=_slicedToArray(_useState,2),noDataPopoverDismissed=_useState2[0],setNoDataPopoverDismissed=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=_slicedToArray(_useState3,2),noDataPopoverVisible=_useState4[0],setNoDataPopoverVisible=_useState4[1];Object(external_kbnSharedDeps_React_["useEffect"])((function(){if(showNoDataPopover&&!noDataPopoverDismissed){setNoDataPopoverVisible(true)}}),[noDataPopoverDismissed,showNoDataPopover]);return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiTourStep"],{onFinish:function onFinish(){},closePopover:function closePopover(){setNoDataPopoverVisible(false)},content:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiText"],{size:"s"},external_kbnSharedDeps_React_default.a.createElement("p",{style:{maxWidth:300}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.noDataPopover.content",{defaultMessage:"This time range doesn't contain any data. Increase or adjust the time range to see more fields and create charts."}))),minWidth:300,anchorPosition:"downCenter",anchorClassName:"eui-displayBlock",step:1,stepsTotal:1,isStepOpen:noDataPopoverVisible,subtitle:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.noDataPopover.subtitle",{defaultMessage:"Tip"}),title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.noDataPopover.title",{defaultMessage:"Empty dataset"}),footerAction:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButtonEmpty"],{size:"xs",flush:"right",color:"text","data-test-subj":"noDataPopoverDismissButton",onClick:function onClick(){storage.set(NO_DATA_POPOVER_STORAGE_KEY,true);setNoDataPopoverDismissed(true);setNoDataPopoverVisible(false)}},external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.noDataPopover.dismissAction",{defaultMessage:"Don't show again"}))},external_kbnSharedDeps_React_default.a.createElement("div",{onFocus:function onFocus(){setNoDataPopoverVisible(false)}},children))}function query_bar_top_row_slicedToArray(arr,i){return query_bar_top_row_arrayWithHoles(arr)||query_bar_top_row_iterableToArrayLimit(arr,i)||query_bar_top_row_unsupportedIterableToArray(arr,i)||query_bar_top_row_nonIterableRest()}function query_bar_top_row_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function query_bar_top_row_unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return query_bar_top_row_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return query_bar_top_row_arrayLikeToArray(o,minLen)}function query_bar_top_row_arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}function query_bar_top_row_iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function query_bar_top_row_arrayWithHoles(arr){if(Array.isArray(arr))return arr}var QueryStringInput=Object(kibana_react_public["withKibana"])(query_string_input["default"]);function QueryBarTopRow(props){var _useState=Object(external_kbnSharedDeps_React_["useState"])(false),_useState2=query_bar_top_row_slicedToArray(_useState,2),isDateRangeInvalid=_useState2[0],setIsDateRangeInvalid=_useState2[1];var _useState3=Object(external_kbnSharedDeps_React_["useState"])(false),_useState4=query_bar_top_row_slicedToArray(_useState3,2),isQueryInputFocused=_useState4[0],setIsQueryInputFocused=_useState4[1];var kibana=Object(kibana_react_public["useKibana"])();var _kibana$services=kibana.services,uiSettings=_kibana$services.uiSettings,notifications=_kibana$services.notifications,storage=_kibana$services.storage,appName=_kibana$services.appName,docLinks=_kibana$services.docLinks;var kueryQuerySyntaxLink=docLinks.links.query.kueryQuerySyntax;var queryLanguage=props.query&&props.query.language;var persistedLog=external_kbnSharedDeps_React_default.a.useMemo((function(){return queryLanguage&&uiSettings&&storage&&appName?Object(public_query["j"])(uiSettings,storage,appName,queryLanguage):undefined}),[appName,queryLanguage,uiSettings,storage]);function onClickSubmitButton(event){if(persistedLog&&props.query){persistedLog.add(props.query.query)}event.preventDefault();onSubmit({query:props.query,dateRange:getDateRange()})}function getDateRange(){var defaultTimeSetting=uiSettings.get(common["UI_SETTINGS"].TIMEPICKER_TIME_DEFAULTS);return{from:props.dateRangeFrom||defaultTimeSetting.from,to:props.dateRangeTo||defaultTimeSetting.to}}function onQueryChange(query){props.onChange({query:query,dateRange:getDateRange()})}function onChangeQueryInputFocus(isFocused){setIsQueryInputFocused(isFocused)}function onTimeChange(_ref){var start=_ref.start,end=_ref.end,isInvalid=_ref.isInvalid,isQuickSelection=_ref.isQuickSelection;setIsDateRangeInvalid(isInvalid);var retVal={query:props.query,dateRange:{from:start,to:end}};if(isQuickSelection){props.onSubmit(retVal)}else{props.onChange(retVal)}}function onRefresh(_ref2){var start=_ref2.start,end=_ref2.end;var retVal={dateRange:{from:start,to:end}};if(props.onRefresh){props.onRefresh(retVal)}}function onSubmit(_ref3){var query=_ref3.query,dateRange=_ref3.dateRange;handleLuceneSyntaxWarning();if(props.timeHistory){props.timeHistory.add(dateRange)}props.onSubmit({query:query,dateRange:dateRange})}function onInputSubmit(query){onSubmit({query:query,dateRange:getDateRange()})}function toAbsoluteString(value){var roundUp=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var valueAsMoment=elastic_datemath_default.a.parse(value,{roundUp:roundUp});if(!valueAsMoment){return value}return valueAsMoment.toISOString()}function renderQueryInput(){if(!shouldRenderQueryInput())return;return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],null,external_kbnSharedDeps_React_default.a.createElement(QueryStringInput,{disableAutoFocus:props.disableAutoFocus,indexPatterns:props.indexPatterns,prepend:props.prepend,query:props.query,screenTitle:props.screenTitle,onChange:onQueryChange,onChangeQueryInputFocus:onChangeQueryInputFocus,onSubmit:onInputSubmit,persistedLog:persistedLog,dataTestSubj:props.dataTestSubj}))}function renderSharingMetaFields(){var _getDateRange=getDateRange(),from=_getDateRange.from,to=_getDateRange.to;var dateRangePretty=Object(external_kbnSharedDeps_ElasticEui_["prettyDuration"])(toAbsoluteString(from),toAbsoluteString(to),[],uiSettings.get("dateFormat"));return external_kbnSharedDeps_React_default.a.createElement("div",{"data-shared-timefilter-duration":dateRangePretty,"data-test-subj":"dataSharedTimefilterDuration"})}function shouldRenderDatePicker(){return Boolean(props.showDatePicker||props.showAutoRefreshOnly)}function shouldRenderQueryInput(){return Boolean(props.showQueryInput&&props.indexPatterns&&props.query&&storage)}function renderUpdateButton(){var button=props.customSubmitButton?external_kbnSharedDeps_React_default.a.cloneElement(props.customSubmitButton,{onClick:onClickSubmitButton}):external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperUpdateButton"],{needsUpdate:props.isDirty,isDisabled:isDateRangeInvalid,isLoading:props.isLoading,onClick:onClickSubmitButton,"data-test-subj":"querySubmitButton"});if(!shouldRenderDatePicker()){return button}return external_kbnSharedDeps_React_default.a.createElement(NoDataPopover,{storage:storage,showNoDataPopover:props.indicateNoData},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{responsive:false,gutterSize:"s"},renderDatePicker(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},button)))}function renderDatePicker(){if(!shouldRenderDatePicker()){return null}var recentlyUsedRanges;if(props.timeHistory){recentlyUsedRanges=props.timeHistory.get().map((function(_ref4){var from=_ref4.from,to=_ref4.to;return{start:from,end:to}}))}var commonlyUsedRanges=uiSettings.get(common["UI_SETTINGS"].TIMEPICKER_QUICK_RANGES).map((function(_ref5){var from=_ref5.from,to=_ref5.to,display=_ref5.display;return{start:from,end:to,label:display}}));var wrapperClasses=classnames_default()("kbnQueryBar__datePickerWrapper",{"kbnQueryBar__datePickerWrapper-isHidden":isQueryInputFocused});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{className:wrapperClasses},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiSuperDatePicker"],{start:props.dateRangeFrom,end:props.dateRangeTo,isPaused:props.isRefreshPaused,refreshInterval:props.refreshInterval,onTimeChange:onTimeChange,onRefresh:onRefresh,onRefreshChange:props.onRefreshChange,showUpdateButton:false,recentlyUsedRanges:recentlyUsedRanges,commonlyUsedRanges:commonlyUsedRanges,dateFormat:uiSettings.get("dateFormat"),isAutoRefreshOnly:props.showAutoRefreshOnly,className:"kbnQueryBar__datePicker"}))}function handleLuceneSyntaxWarning(){if(!props.query)return;var _props$query=props.query,query=_props$query.query,language=_props$query.language;if(language==="kuery"&&typeof query==="string"&&(!storage||!storage.get("kibana.luceneSyntaxWarningOptOut"))&&Object(common["doesKueryExpressionHaveLuceneSyntaxError"])(query)){var toast=notifications.toasts.addWarning({title:external_kbnSharedDeps_KbnI18n_["i18n"].translate("data.query.queryBar.luceneSyntaxWarningTitle",{defaultMessage:"Lucene syntax warning"}),text:Object(kibana_react_public["toMountPoint"])(external_kbnSharedDeps_React_default.a.createElement("div",null,external_kbnSharedDeps_React_default.a.createElement("p",null,external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.query.queryBar.luceneSyntaxWarningMessage",defaultMessage:"It looks like you may be trying to use Lucene query syntax, although you have Kibana Query Language (KQL) selected. Please review the KQL docs {link}.",values:{link:external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiLink"],{href:kueryQuerySyntaxLink,target:"_blank"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.query.queryBar.syntaxOptionsDescription.docsLinkText",defaultMessage:"here"}))}})),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{justifyContent:"flexEnd",gutterSize:"s"},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiButton"],{size:"s",onClick:function onClick(){return onLuceneSyntaxWarningOptOut(toast)}},external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_KbnI18nReact_["FormattedMessage"],{id:"data.query.queryBar.luceneSyntaxWarningOptOutText",defaultMessage:"Don't show again"}))))))})}}function onLuceneSyntaxWarningOptOut(toast){if(!storage)return;storage.set("kibana.luceneSyntaxWarningOptOut",true);notifications.toasts.remove(toast)}var classes=classnames_default()("kbnQueryBar",{"kbnQueryBar--withDatePicker":props.showDatePicker});return external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexGroup"],{className:classes,responsive:!!props.showDatePicker,gutterSize:"s",justifyContent:"flexEnd"},renderQueryInput(),renderSharingMetaFields(),external_kbnSharedDeps_React_default.a.createElement(external_kbnSharedDeps_ElasticEui_["EuiFlexItem"],{grow:false},renderUpdateButton()))}QueryBarTopRow.defaultProps={showQueryInput:true,showDatePicker:true,showAutoRefreshOnly:false}}}]);