"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ErrorHandler = ErrorHandler;

var _logger = require("../../lib/logger");

var _getConfiguration = require("../../lib/get-configuration");

const DEBUG = 'debug';
const INFO = 'info';
const ERROR = 'error';
const COLOR = '\u001b[34mwazuh\u001b[39m';

function logLevel(level) {
  return level === DEBUG ? INFO : level;
}

;

function ErrorHandler(error, serverLogger) {
  const {
    ['logs.level']: logsLevel
  } = (0, _getConfiguration.getConfiguration)();
  const errorLevel = ErrorLevels[error.error] || ERROR;
  (0, _logger.log)('Cron-scheduler', error, errorLevel === ERROR ? INFO : errorLevel);

  try {
    if (errorLevel === DEBUG && logsLevel !== DEBUG) return;
    serverLogger[logLevel(errorLevel)](`${JSON.stringify(error)}`);
  } catch (error) {
    serverLogger[logLevel(errorLevel)](`Message to long to show in console output, check the log file`);
  }
}

const ErrorLevels = {
  401: INFO,
  403: ERROR,
  409: DEBUG,
  3005: INFO,
  3013: DEBUG,
  10001: INFO,
  10002: DEBUG,
  10003: DEBUG,
  10004: DEBUG,
  10005: DEBUG,
  10006: DEBUG,
  10007: DEBUG
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9yLWhhbmRsZXIudHMiXSwibmFtZXMiOlsiREVCVUciLCJJTkZPIiwiRVJST1IiLCJDT0xPUiIsImxvZ0xldmVsIiwibGV2ZWwiLCJFcnJvckhhbmRsZXIiLCJlcnJvciIsInNlcnZlckxvZ2dlciIsImxvZ3NMZXZlbCIsImVycm9yTGV2ZWwiLCJFcnJvckxldmVscyIsIkpTT04iLCJzdHJpbmdpZnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxLQUFLLEdBQUcsT0FBZDtBQUNBLE1BQU1DLElBQUksR0FBRyxNQUFiO0FBQ0EsTUFBTUMsS0FBSyxHQUFHLE9BQWQ7QUFDQSxNQUFNQyxLQUFLLEdBQUcsMkJBQWQ7O0FBRUEsU0FBU0MsUUFBVCxDQUFrQkMsS0FBbEIsRUFBZ0M7QUFDOUIsU0FBT0EsS0FBSyxLQUFLTCxLQUFWLEdBQWtCQyxJQUFsQixHQUF5QkksS0FBaEM7QUFDRDs7QUFBQTs7QUFFTSxTQUFTQyxZQUFULENBQXNCQyxLQUF0QixFQUE2QkMsWUFBN0IsRUFBMkM7QUFDaEQsUUFBTTtBQUFFLEtBQUMsWUFBRCxHQUFnQkM7QUFBbEIsTUFBZ0MseUNBQXRDO0FBQ0EsUUFBTUMsVUFBVSxHQUFHQyxXQUFXLENBQUNKLEtBQUssQ0FBQ0EsS0FBUCxDQUFYLElBQTRCTCxLQUEvQztBQUNBLG1CQUFJLGdCQUFKLEVBQXNCSyxLQUF0QixFQUE2QkcsVUFBVSxLQUFLUixLQUFmLEdBQXVCRCxJQUF2QixHQUE4QlMsVUFBM0Q7O0FBQ0EsTUFBSTtBQUNGLFFBQUlBLFVBQVUsS0FBS1YsS0FBZixJQUF3QlMsU0FBUyxLQUFLVCxLQUExQyxFQUFpRDtBQUNqRFEsSUFBQUEsWUFBWSxDQUFDSixRQUFRLENBQUNNLFVBQUQsQ0FBVCxDQUFaLENBQW9DLEdBQUVFLElBQUksQ0FBQ0MsU0FBTCxDQUFlTixLQUFmLENBQXNCLEVBQTVEO0FBQ0QsR0FIRCxDQUdFLE9BQU9BLEtBQVAsRUFBYztBQUNkQyxJQUFBQSxZQUFZLENBQUNKLFFBQVEsQ0FBQ00sVUFBRCxDQUFULENBQVosQ0FBb0MsK0RBQXBDO0FBQ0Q7QUFDRjs7QUFFRCxNQUFNQyxXQUFXLEdBQUc7QUFDbEIsT0FBS1YsSUFEYTtBQUVsQixPQUFLQyxLQUZhO0FBR2xCLE9BQUtGLEtBSGE7QUFJbEIsUUFBTUMsSUFKWTtBQUtsQixRQUFNRCxLQUxZO0FBTWxCLFNBQU9DLElBTlc7QUFPbEIsU0FBT0QsS0FQVztBQVFsQixTQUFPQSxLQVJXO0FBU2xCLFNBQU9BLEtBVFc7QUFVbEIsU0FBT0EsS0FWVztBQVdsQixTQUFPQSxLQVhXO0FBWWxCLFNBQU9BO0FBWlcsQ0FBcEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsb2cgfSBmcm9tICcuLi8uLi9saWIvbG9nZ2VyJztcbmltcG9ydCB7IGdldENvbmZpZ3VyYXRpb24gfSBmcm9tICcuLi8uLi9saWIvZ2V0LWNvbmZpZ3VyYXRpb24nO1xuXG5jb25zdCBERUJVRyA9ICdkZWJ1Zyc7XG5jb25zdCBJTkZPID0gJ2luZm8nO1xuY29uc3QgRVJST1IgPSAnZXJyb3InO1xuY29uc3QgQ09MT1IgPSAnXFx1MDAxYlszNG13YXp1aFxcdTAwMWJbMzltJztcblxuZnVuY3Rpb24gbG9nTGV2ZWwobGV2ZWw6IHN0cmluZyl7XG4gIHJldHVybiBsZXZlbCA9PT0gREVCVUcgPyBJTkZPIDogbGV2ZWw7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gRXJyb3JIYW5kbGVyKGVycm9yLCBzZXJ2ZXJMb2dnZXIpIHtcbiAgY29uc3QgeyBbJ2xvZ3MubGV2ZWwnXTogbG9nc0xldmVsIH0gPSBnZXRDb25maWd1cmF0aW9uKCk7XG4gIGNvbnN0IGVycm9yTGV2ZWwgPSBFcnJvckxldmVsc1tlcnJvci5lcnJvcl0gfHwgRVJST1I7XG4gIGxvZygnQ3Jvbi1zY2hlZHVsZXInLCBlcnJvciwgZXJyb3JMZXZlbCA9PT0gRVJST1IgPyBJTkZPIDogZXJyb3JMZXZlbCk7XG4gIHRyeSB7XG4gICAgaWYgKGVycm9yTGV2ZWwgPT09IERFQlVHICYmIGxvZ3NMZXZlbCAhPT0gREVCVUcpIHJldHVybjtcbiAgICBzZXJ2ZXJMb2dnZXJbbG9nTGV2ZWwoZXJyb3JMZXZlbCldKGAke0pTT04uc3RyaW5naWZ5KGVycm9yKX1gKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBzZXJ2ZXJMb2dnZXJbbG9nTGV2ZWwoZXJyb3JMZXZlbCldKGBNZXNzYWdlIHRvIGxvbmcgdG8gc2hvdyBpbiBjb25zb2xlIG91dHB1dCwgY2hlY2sgdGhlIGxvZyBmaWxlYClcbiAgfVxufVxuXG5jb25zdCBFcnJvckxldmVscyA9IHtcbiAgNDAxOiBJTkZPLFxuICA0MDM6IEVSUk9SLFxuICA0MDk6IERFQlVHLFxuICAzMDA1OiBJTkZPLFxuICAzMDEzOiBERUJVRyxcbiAgMTAwMDE6IElORk8sXG4gIDEwMDAyOiBERUJVRyxcbiAgMTAwMDM6IERFQlVHLFxuICAxMDAwNDogREVCVUcsXG4gIDEwMDA1OiBERUJVRyxcbiAgMTAwMDY6IERFQlVHLFxuICAxMDAwNzogREVCVUcsXG59Il19